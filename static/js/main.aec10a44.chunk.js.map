{"version":3,"sources":["config/default/logo_intranets.png","components/WidthProvider.jsx","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/ViewErrors.js","components/MouseOver.js","helpers/trace.js","helpers/OfficeGraph/index.js","helpers/LaunchPad.js","components/ViewTeams.js","config/index.js","helpers/index.js","components/BreakPointSelector.js","components/AddBoard.js","App.js","components/MyTeam.js","Home.js","Onboard.js","authenticate.js","helpers/License.js","components/DragableDetailsList.js","helpers/UserContext.js","containers/Wrapper/index.js","containers/HomePage/index.js","containers/StartDatePage/index.js","containers/StartDateTeamSelectedPage/index.js","index.js","components/ToolboxLayout.js"],"names":["module","exports","WidthProvider","ComposedComponent","fixedWidth","state","width","mounted","onWindowResize","node","ReactDOM","findDOMNode","HTMLElement","setState","offsetWidth","this","window","addEventListener","removeEventListener","prevProps","prevState","props","measureBeforeMount","rest","className","style","React","Component","defaultProps","Tags","references","display","flexWrap","map","group","key","padding","margin","backgroundColor","color","textColor","title","Highlight","text","filter","ix","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","tile","useState","tileSize","border","maxWidth","textcolor","height","maxHeight","borderRadius","overflow","cursor","onClick","marginTop","src","icon","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","ViewErrors","errors","error","context","JSON","stringify","theme","ContextualMenu","getTheme","EVENT","mergeStyleSets","container","flexFlow","header","fonts","xLargePlus","flex","borderTop","palette","themePrimary","neutralPrimary","fontWeight","FontWeights","semibold","body","overflowY","selectors","p","marginBottom","neutralDark","LANDING","ONBOARDING","SEARCHING","SEARCHCLICKED","TILECLICKED","TABCLICKED","DETAILSTOGGLED","MEMBERSHIPSREAD","who","upn","amplitude","amp","getInstance","setUserId","s","split","setDomain","trace","event","details","logEvent","console","log","Object","freeze","graph","storageProvider","localStorage","analyseMembers","token","emailAddresses","cb","addresses","forEach","element1","element2","match","smtp","push","checked","results","x","address","readUser","err","user","invite","emailAddress","invitationRedirectUrl","post","invitedUserEmailAddress","inviteRedirectUrl","invitedUserDisplayName","sendInvitationMessage","invitedUserMessageInfo","customizedMessageBody","ccRecipients","name","response","addcrm","tag","msg","properties","property","value","post2","addmember","userId","groupId","getSharePointList","host","site","list","listfilter","itemfilter","get","items","itemList","next","item","pop","id","getPages","readGroupMembers","readGroupMemberShipFor","readManager","userPrincipalName","index","matchingGroups","searchText","findGroup","getGroupDocuments","folderName","getGroupDrive","getGroupSite","getDriveChildren","driveId","itemId","getGroupRootFolders","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","copyfile","groupNickName","fromFolder","fromName","toFolder","toName","groups","fromItems","_","find","targetFolders","destFolder","newDoc","parentReference","result","sourceGroupId","lookupFile","iterations","file","iteration","setTimeout","Client","url","options","Promise","resolve","reject","payload","patch","axios","headers","authorization","then","data","catch","put","getRaw","request","getImage","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","readAsDataURL","open","setRequestHeader","responseType","send","auth","getAccessToken","get2","put2","me","MyTeams","MyTeam","readTeam","getMyExtention","extensionName","getOneDriveFolder","folderNameWithOutInitialSlash","getOneDriveFolderContent","getOneDriveFile","filename","a","folder","saveOneDriveFile","createOneDriveFolder","createOneDriveFolderChild","parentFolderNameWithOutInitialSlash","driveItem","saveMyExtention","updateMyExtention","r","addMyExtention","patch2","teamMemberships","reportProgessPercent","client","memberships","pending","total","processed","readGroup","sort","b","displayName","description","photo","creationOptions","v","hasYammer","hasSharePoint","resourceProvisioningOptions","readChannels","channels","readEndpoints","endPoints","hasTeams","undefined","readTeamInfoAsGuest","readChannelsAsGuest","queue","channel","tabs","appendTo","retrycount","parsedBody","errCounter","parse","followNextLink","skipNextLink","concat","getItem","extentionName","OURPATH","BOARDSPATH","BOARDS","OURCONFIGFILENAME","BOARDINDEXFILENAME","saveCache","membershipIndex","membership","cachedFileName","readCache","verifyAccessForLanuchPad","setCheckMe","setCheckMyExtention","setCheckOneDrive","setCheckOneDriveFiles","setCheckMemberships","setCheckTeam","checkAccessToConfig","version","projectInfo","message","checkAccessToContexts","m","hello","extention","teamId","member","buffer","layouts","delaywriteLayouts","writing","writeLayouts","isEqual","current","readBoards","ctx","fullname","content","myTeams","team","getHref","readLayouts","readBoardFiles","files","Axios","webUrl","uniqueEndPoints","groupBy","endPoint","providerName","jumpto","uri","part2","part4","part5","threadId","tenantId","conversationsHref","teamsLink","readIndexOfLaunzhBoards","breakpointColumnsObj","default","3600","3300","3000","2700","2400","2100","1800","1500","1200","900","600","ViewTeams","viewDates","memberShips","cloneDeep","tiles","sortBy","minWidth","breakpointCols","columnClassName","ViewTeam","viewChannels","onSaveTeam","clientId","directoryId","scopes","logo","components","borderBottom","position","left","top","zIndex","textDecoration","fontFamily","paddingTop","marginRight","getSearchParametersFromHRef","search","s1","s2","s3","decodeURIComponent","inIframe","self","teamsMeetingUrlFromBody","BreakPointSelector","breakPoints","breakpoints","keys","breakPoint","selected","onSelect","dialogContentProps","mergeStyles","hiddenContentStyle","type","DialogType","normal","closeButtonAriaLabel","subText","AddBoard","hideDialog","setHideDialog","setName","useId","Dialog","hidden","onDismiss","TextField","autoFocus","label","onChange","newValue","placeholder","xiconProps","iconName","DialogFooter","PrimaryButton","disabled","onAdd","DefaultButton","logSearchTimer","searchInfo","dragOptions","moveMenuItemText","closeMenuItemText","menu","cancelIcon","contentStyles","minHeight","iconButtonStyles","root","rootHovered","initializeIcons","App","inFrame","searchIconRef","useRef","config","teamsIntegration","upnIs","niels","showTabFeature","titlegraphics","setTitlegraphics","_setFilter","setSearch","setTiles","isZoomed","setIsZoomed","setCurrentTile","myTools","setMyTeams","ztickyRef","setZtickyRef","setErrors","setMemberships","contexts","setContexts","board","selectedBoard","setSelectedBoard","refreshing","setRefresing","progress","setProgress","progressPercent","setProgressPercent","showTable","showFilterOptions","tableUrl","setTableUrl","lg","setLayouts","setJoinedTeams","refreshCounter","setRefreshCounter","tags","showDetails","_setShowDetails","showCatalogue","_setShowCatalogue","editMode","_setEditMode","isFixedWidth","isLoaded","setIsLoaded","selectedGroup","setGroups","isModalOpen","setIsModalOpen","selectedBreakPoint","setSelectedBreakPoint","isMounted","setIsMounted","isDirty","setIsDirty","showWarning","setShowWarning","indexLaunzhContexts","setIndexLaunzhContexts","myDrive","setMyDrive","addingBoard","setAddingBoard","gotoBoard","boardName","location","setEditMode","on","setFilter","startsWith","removePin","pinId","splice","i","toString","addPin","_team","y","w","h","showSearch","readGrid","tableId","grid","groupRefs","row","cell","groupSetting","members","refs","ga","sortKey","toLower","correlation","initGraph","refresh","queueCount","teams","localCache","cachedMemberships","setItem","percent","matchFilter","subTitle","boardFileName","useEffect","document","ztickyref","defaultTableAPI","ctxs","endsWith","l","defaultTableKey","drive","load","filteredTiles","filteredMyTools","filteredMemberShips","URL","include","visibility","matchTeam","clearTimeout","editorCanvasWidth","ProgressIndicator","percentComplete","xlabel","xdescription","bottom","right","paddingRight","Dropdown","selectedKey","onChanged","option","styles","dropdown","xmarginTop","IconButton","iconProps","ariaLabel","saveLayout","Toggle","CommandBar","farItems","iconOnly","subMenuProps","navigate","signOut","ref","Spinner","MessageBar","messageBarType","MessageBarType","warning","isMultiline","dismissButtonAriaLabel","xactions","MessageBarButton","Coachmark","positioningContainerProps","directionalHint","DirectionalHint","topAutoEdge","doNotLayer","ariaAlertText","ariaDescribedBy","ariaLabelledBy","ariaDescribedByText","ariaLabelledByText","ToolboxLayout","tools","persist","newLayouts","getPin","parseInt","onRemovePin","onTileClick","Modal","titleAriaId","isOpen","isBlocking","containerClassName","xdragOptions","onSaveChannel","identify","messageBeforeLaunch","borderLeft","float","Office","initialize","joinedTeams","onMeetNow","speedDate","setSpeedDate","processing","setProcessing","meetingUrl","setMeetingUrl","info","actions","sponsor","mail","method","linkText","subject","from","to","teamName","facilitator1","facilitator2","optionalAttendeesEmails","attendeesEmails","Onboard","checkMe","checkMemberships","checkTeam","checkMyExtention","run","dir","hasReturnPath","GETACCESSTOKEN","RESTOREURL","GETGRAPHUSER","LOGIN","ACCESSTOKEN","ACCESSEXPIRES","isAccessTokenExpired","exp","expiresIn","moment","diff","getReturnPath","subPath","hostname","protocol","port","selectAccount","client_id","scope","redirect_uri","removeItem","authenticate","callBackNotifyIfInteractionIsRequired","seq","getSearchParametersFromHash","search2","id_token","access_token","login","handled","error_description","expires","add","expires_in","toISOString","newHref","reload","getLicenseForUPN","domain","overflowProps","dragEnterClass","neutralLight","UserContext","Consumer","Wrapper","children","HomePage","errorMessage","setErrorMessage","email","setEmail","isProcessing","setIsProcessing","mailInput","focus","processEmail","affiliated","setReturnPath","signinWith","componentRef","required","defaultValue","test","validateEmail","StartDatePage","_meetingUrl","xclassName","format","meetNow","StartDateTeamSelectedPage","setTeam","setChannels","teamid","ErrorBoundary","hasError","viewDetails","componentStack","readOnly","rows","cols","loadTheme","defaultFontStyle","small","medium","large","xLarge","Container","GotoDefault","GetAdminConsented","getAdminConsent","AdminConsented","SignedOut","SignOut","NoPage","Debug","InteractionRequired","noauthPaths","skipAuth","currentPath","pathname","noauthPath","interactionRequired","SpeedDateApp","setAuth","setLicense","setInteractionRequired","license","Customizer","FluentCustomizations","Fabric","pack","hash","render","getElementById","start","ResponsiveReactGridLayout","md","sm","xs","xxs","onBreakpointChange","breakpoint","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","compactType","onTakeItem","onPutItem","onLayoutChange","layout","global","onNewLayout","generateLayout","onResize","tool","Responsive","that","Date","now","editingLayout","data-grid","static","containerPadding","useCSSTransforms","preventCollision","isDraggable","isResizable","generateDOM","range","Math","ceil","random","floor","rowHeight","initialLayout"],"mappings":"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","file":"static/js/main.aec10a44.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactDOM from \"react-dom\";\n\n\n\n\n/*\n * A simple HOC that provides facility for listening to container resizes.\n */\nexport default function WidthProvider(\n  ComposedComponent,fixedWidth\n) {\n  return class WidthProvider extends React.Component {\n    static defaultProps = {\n      measureBeforeMount: false\n    };\n\n    static propTypes = {\n      // If true, will not render children until mounted. Useful for getting the exact width before\n      // rendering, to prevent any unsightly resizing.\n      measureBeforeMount: PropTypes.bool\n    };\n\n    state = {\n      width: 1200\n    };\n\n    mounted = false;\n\n    componentDidMount() {\n      this.mounted = true;\n\n      window.addEventListener(\"resize\", this.onWindowResize);\n      // Call to properly set the breakpoint and resize the elements.\n      // Note that if you're doing a full-width element, this can get a little wonky if a scrollbar\n      // appears because of the grid. In that case, fire your own resize event, or set `overflow: scroll` on your body.\n      this.onWindowResize();\n    }\n\n    componentWillUnmount() {\n      this.mounted = false;\n      window.removeEventListener(\"resize\", this.onWindowResize);\n    }\n    componentDidUpdate(prevProps,prevState) {\n      //debugger\n      if (this.props.fixedWidth && (this.props.fixedWidth  !== prevProps.fixedWidth) ){\n        //debugger\n        this.setState({width:this.props.fixedWidth })\n      }\n      \n    }\n    onWindowResize = () => {\n      if (!this.mounted) return;\n      // eslint-disable-next-line react/no-find-dom-node\n      const node = ReactDOM.findDOMNode(this); // Flow casts this to Text | Element\n            \n      if (node instanceof HTMLElement)\n        this.setState({ width:  node.offsetWidth < 1200 ? node.offsetWidth : 1200 });\n    };\n\n    render() {\n      const { measureBeforeMount, ...rest } = this.props;\n      if (measureBeforeMount && !this.mounted) {\n        return (\n          <div className={this.props.className} style={this.props.style} />\n        );\n      }\n\n      return <ComposedComponent {...rest} {...this.state} />;\n    }\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Tags = props => {\n  if (props && props.references) {\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\n      {props.references.map((group,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\n          {group.title}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nTags.propTypes = {\n  references: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Highlight = props => {\n  \nif (!props.text) return null\nif (!props.filter) return  props.text\n\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\n   if (ix===-1){\n     return props.text\n   }\n\n   \n   var first = props.text.substr(0,ix)\n   var middle = props.text.substr(ix,props.filter.length)\n   var last = props.text.substr(ix+props.filter.length)\n  return (\n    <>\n   \n      <span>{first}</span>\n      <span style={props.style}>{middle}</span>\n       <span>{last}</span>\n    \n    </>\n  );\n};\nHighlight.propTypes = {\n  style: PropTypes.object,\n\n  filter: PropTypes.string,\n  text: PropTypes.string\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nimport { Highlight } from \"./Highlight\";\nimport  \"./tile.css\"\nexport const AppSuperTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n\n  return (<>\n\n  {props.tileSize===1 &&\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n     <div  style={{\n       \n       margin: 10,\n       padding: 10,\n       backgroundColor: tile.color,\n       color: tile.textcolor,\n       width: 300,\n       height: 70,\n       maxHeight: 70,\n       borderRadius:35,\n       overflow: \"hide\"\n       \n     }}>\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\n         if (props.onClick){\n           props.onClick(tile);\n                }\n   \n       }}>\n         <div style={{display:\"flex\"}}>\n           \n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\n         </div>\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \n           </div>\n          \n         <div style={{alignItems:\"flex-end\"}}>\n         <i\n                   style={{cursor:\"pointer\",display:\"none\"}}\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                     onClick={(e) => {\n                       if (props.onPinnedClicked){\n                         e.preventDefault()\n                         e.stopPropagation()\n                         props.onPinnedClicked(props)\n                       }\n                       \n                     }}\n                     aria-hidden=\"true\"\n                   ></i> \n         </div> </div>\n       \n         {/* <Tags references={tile.references} /> */}\n   \n       </div>\n     </div>\n     \n\n     </div>\n  }\n  {props.tileSize === 0 &&\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n  <div style={{\n    margin: 10,\n    padding: 10,\n    backgroundColor: tile.color,\n    color: tile.textcolor,\n    width: 300,\n    height: 300,\n    maxHeight: 300,\n    overflow: \"auto\"\n  }}>\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\n      if (props.onClick){\n        props.onClick(tile);\n             }\n\n    }}>\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\n      <div style={{alignItems:\"flex-end\"}}>\n      <i\n                style={{cursor:\"pointer\",display:\"none\"}}\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                  onClick={(e) => {\n                    if (props.onPinnedClicked){\n                      e.preventDefault()\n                      e.stopPropagation()\n                      props.onPinnedClicked(props)\n                    }\n                    \n                  }}\n                  aria-hidden=\"true\"\n                ></i> \n      </div>\n      </div>\n      \n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\n      </div>\n\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\n    \n\n        {tile.inShort}\n      </div>\n       <Tags references={tile.references} /> \n\n    </div>\n  </div>\n  \n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\n          Jump to\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\n           More info\n            </a>)}\n      </div>\n  </div>\n  }\n  </>);\n};\nAppSuperTile.propTypes = {\n  tile: PropTypes.object,\n  onClose: PropTypes.func,\n  filter : PropTypes.string,\n  highlightStyle : PropTypes.object,\n  isPinned : PropTypes.bool,\n  onPinnedClicked:PropTypes.func,\n  tileSize:PropTypes.number\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const ViewErrors = props => {\n  if (props && props.errors) {\n    return (<div className=\"tags\" >\n      {props.errors.map((error,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", }}>\n          When trying {error.context}, you got \n          {JSON.stringify(error)}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nViewErrors.propTypes = {\n  errors: PropTypes.array\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./groupover.css\";\nimport {\n  getTheme,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n} from \"office-ui-fabric-react\";\nconst dragOptions = {\n  moveMenuItemText: \"Move\",\n  closeMenuItemText: \"Close\",\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: \"Cancel\" };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n    alignItems: \"stretch\",\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: \"1 1 auto\",\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: \"flex\",\n      alignItems: \"center\",\n      fontWeight: FontWeights.semibold,\n      padding: \"12px 12px 14px 24px\",\n    },\n  ],\n  body: {\n    flex: \"4 4 auto\",\n    padding: \"0 24px 24px 24px\",\n    overflowY: \"hidden\",\n    selectors: {\n      p: { margin: \"14px 0\" },\n      \"p:first-child\": { marginTop: 0 },\n      \"p:last-child\": { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: \"auto\",\n    marginTop: \"4px\",\n    marginRight: \"2px\",\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nexport const GroupMouseOver = (props) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <div className=\"groupOver\">\n      <div className=\"groupOverLink\">\n        <div style={{ display: \"flex\" }}>\n          <div\n            style={{ flexGrow: 1 }}\n            onClick={(e) => {\n              setIsModalOpen(true);\n              e.preventDefault();\n            }}\n          >\n            Open{\" \"}\n          </div>\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\n            onClick={(e) => {\n              e.preventDefault();\n              \n              if (props.onSave) {\n                props.onSave();\n              }\n            }}\n          >\n            Save\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={() => setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div>\n          <span>Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={() => setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}></div>\n      </Modal>\n    </div>\n  );\n};\n\n\nexport const PinMouseOver = (props) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <div className=\"groupOver\" style={{zIndex:3}}>\n      <div className=\"groupOverLink\">\n        <div style={{ display: \"flex\" }}>\n          <div\n            style={{ flexGrow: 1 }}\n            onClick={(e) => {\n              setIsModalOpen(true);\n              e.preventDefault();\n            }}\n          >\n            Open{\" \"}\n          </div>\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\n            onClick={(e) => {\n              \n              e.preventDefault();\n              \n              if (props.onRemove) {\n                props.onRemove();\n              }\n            }}\n          >\n            Remove\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={() => setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div>\n          <span>Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={() => setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}></div>\n      </Modal>\n    </div>\n  );\n};\n","export const EVENT = {\n  LANDING: \"landing\",\n  ONBOARDING: \"onboarding\",\n  SEARCHING: \"user-searched-for\",\n  SEARCHCLICKED: \"user-clicked-search\",\n  TILECLICKED: \"user-clicked-tile\",\n  TABCLICKED: \"user-clicked-tab\",\n  DETAILSTOGGLED: \"user-toggle-details\",\n  MEMBERSHIPSREAD:\"memberships-read\"\n};\nObject.freeze(EVENT);\n// var d = [\n//     \"init\",\n//     \"logEvent\",\n//     \"logRevenue\",\n//     \"setUserId\",\n//     \"setUserProperties\",\n//     \"setOptOut\",\n//     \"setVersionName\",\n//     \"setDomain\",\n//     \"setDeviceId\",\n//     \"enableTracking\",\n//     \"setGlobalUserProperties\",\n//     \"identify\",\n//     \"clearUserProperties\",\n//     \"setGroup\",\n//     \"logRevenueV2\",\n//     \"regenerateDeviceId\",\n//     \"groupIdentify\",\n//     \"onInit\",\n//     \"logEventWithTimestamp\",\n//     \"logEventWithGroups\",\n//     \"setSessionId\",\n//     \"resetSessionId\",\n//   ];\nexport function who(upn) {\n  if (!window.amplitude) return;\n  if (!upn) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  \n  amp.setUserId(upn);\n\n  var s = upn.split(\"@\");\n  if (s.length === 2) {\n    amp.setDomain(s[1]);\n  }\n}\n\nexport function trace(event, details) {\n  if (!window.amplitude) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  amp.logEvent(event, details);\n  console.log(\"trace\",event, details);\n}\n","import json from \"format-json\";\nimport _ from \"lodash\";\nimport request from \"request\";\nimport axios from \"axios\";\nimport { addElementAtIndex } from \"@fluentui/react\";\nexport var graph = {};\nconst storageProvider = localStorage\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n  var addresses = [];\n\n  var ar1 = emailAddresses.split(\"\\n\");\n  ar1.forEach((element1) => {\n    var ar2 = element1.split(\";\");\n    ar2.forEach((element2) => {\n      var smptAddresses = extractEmails(element2);\n      smptAddresses.forEach((smtp) => {\n        addresses.push({\n          checked: false,\n          smtp,\n        });\n      });\n    });\n  });\n\n  var results = [];\n  var x = addresses.length;\n  addresses.forEach((address) => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--;\n      address.user = user;\n      address.err = err;\n      results.push(address);\n      if (x < 1) {\n        cb(null, results);\n        address.checked = true;\n      }\n    });\n  });\n};\ngraph.invite = (token, emailAddress, invitationRedirectUrl, cb) => {\n  var msg = {\n    invitedUserEmailAddress: emailAddress,\n    inviteRedirectUrl: invitationRedirectUrl,\n    invitedUserDisplayName: emailAddress,\n    sendInvitationMessage: false,\n    invitedUserMessageInfo: {\n      customizedMessageBody:\n        \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n      ccRecipients: [\n        {\n          emailAddress: {\n            name: \"Niels\",\n            address: \"niels@jumpto365.com\",\n          },\n        },\n      ],\n    },\n  };\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, function (\n    err,\n    response\n  ) {\n    if (err) {\n      return cb(err);\n    }\n    cb(null, response);\n  });\n};\ngraph.addcrm = (token, emailAddress, first, last, tag, cb) => {\n  var msg = {\n    properties: [\n      {\n        property: \"firstname\",\n        value: first,\n      },\n      {\n        property: \"lastname\",\n        value: last,\n      },\n      {\n        property: \"internal_categories\",\n        value: tag,\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ],\n  };\n\n  post2(\n    token,\n    `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null, response);\n    }\n  );\n};\ngraph.addmember = (token, userId, groupId, cb) => {\n  var msg = {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`,\n  };\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null);\n    }\n  );\n};\n\ngraph.getSharePointList = (\n  token,\n  host,\n  site,\n  list,\n  listfilter,\n  itemfilter,\n  cb\n) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`,\n    function (e, items) {\n      if (e) return cb(e);\n      var itemList = [];\n\n      function next() {\n        if (items.length === 0) return cb(null, itemList);\n        var item = items.pop();\n\n        get(\n          token,\n          `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`,\n          function (e, item) {\n            if (e) return cb(e);\n            itemList.push(item);\n            next();\n          }\n        );\n      }\n\n      next();\n    }\n  );\n};\n\ngraph.getPages = (token, host, site, cb) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}`,\n    function (e, site) {\n      if (e) return cb(e);\n\n      get(\n        token,\n        `https://graph.microsoft.com/beta/sites/${site.id}/pages`,\n        function (e, items) {\n          if (e) return cb(e);\n\n          return cb(null, items);\n        }\n      );\n    }\n  );\n};\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/beta/groups/\" +\n      groupId +\n      \"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id\",\n    cb\n  );\n};\n\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, \"https://graph.microsoft.com/v1.0/users/\" + upn + \"/memberOf\", cb);\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName + \"/manager\",\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`,\n    cb\n  );\n};\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`,\n    cb\n  );\n};\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`,\n    cb\n  );\n};\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb);\n};\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`,\n    cb\n  );\n};\n\ngraph.getDriveChildren = function (token, driveId, itemId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`,\n    cb\n  );\n};\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteDrive = function (token, id, path, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.copyfile = function (\n  token,\n  groupNickName,\n  fromFolder,\n  fromName,\n  toFolder,\n  toName,\n  cb\n) {\n  graph.findGroup(token, groupNickName, function (err, groups) {\n    if (err) return cb(err);\n    if (groups.length !== 1) return cb(\"Did't find a unique group\");\n    var group = groups[0];\n    graph.getGroupDocuments(token, group.id, \"/\" + fromFolder, function (\n      err,\n      fromItems\n    ) {\n      if (err) return cb(err);\n      var match = _.find(fromItems, { name: fromName });\n      graph.getGroupRootFolders(token, group.id, function (err, targetFolders) {\n        if (err) return cb(err);\n        var destFolder = _.find(targetFolders, { name: toFolder });\n        if (!destFolder) return cb(\"Did't find target folder\");\n        graph.newDoc(\n          token,\n          group.id,\n          match.id,\n          destFolder.parentReference.driveId,\n          destFolder.id,\n          toName,\n          function (err, result) {\n            if (err) return cb(err);\n            return cb(null, result);\n          }\n        );\n      });\n    });\n  });\n};\n\nfunction lookupFile(token, driveId, id, name, iterations, cb) {\n  // Content have been copied\n  graph.getDriveChildren(token, driveId, id, function (err, result) {\n    if (err) {\n      return cb(err);\n    }\n    // content of destination folder\n\n    for (let index = 0; index < result.length; index++) {\n      const file = result[index];\n\n      console.log(\"Comparing\", file.name, name);\n      if (file.name === name) {\n        // match found\n        console.log(\"Match found\");\n        return cb(null, file);\n      }\n    }\n\n    var iteration = 0;\n    function retry() {\n      console.log(\"Retrying\", iterations);\n      //\n      if (iteration > 10) {\n        return cb(\n          `Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `\n        );\n      }\n      lookupFile(token, driveId, id, name, iterations + 1, cb);\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000);\n  });\n}\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`,\n    {\n      parentReference: {\n        driveId: driveId,\n        id: id,\n      },\n      name: name,\n    },\n    function (err) {\n      // no result from that call - by design from Microsoft\n      if (err) {\n        return cb(err);\n      }\n\n      // so we fill try to find a referece our self\n      lookupFile(token, driveId, id, name, 0, cb);\n    }\n  );\n};\nexport const graphWithPromise = {};\ngraphWithPromise.me = (token) => {\n  return new Promise((resolve, reject) => {\n    get(\n      token,\n      \"https://graph.microsoft.com/v1.0/me/\",\n      (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      },\n      null\n    );\n  });\n};\n\nclass Client {\n  constructor() {\n    this.token = auth.getAccessToken();\n  }\n  get = (url,options) => {\n    return new Promise((resolve, reject) => {\n      get(this.token, url, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      }, null,null,null,options);\n    });\n  };\n\n  post = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      post(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  patch = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      patch(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  put = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      put(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  getRaw = (url) => {\n    return getRaw(this.token, url);\n  };\n  getImage = (url) => {\n    return getImage(this.token, url);\n  };\n}\n\nfunction imageToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    try {\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        var blobAsDataUrl = reader.result;\n\n        resolve(blobAsDataUrl);\n      };\n\n      reader.readAsDataURL(new Blob([blob]));\n    } catch (error) {\n      \n      resolve(null);\n    }\n  });\n}\nconst get2 = (url,options) => {\n  var client = new Client();\n  return client.get(url,options);\n};\n\nconst patch2 = (url, payload) => {\n  var client = new Client();\n  return client.patch(url, payload);\n};\nconst post2 = (url, payload) => {\n  var client = new Client();\n  return client.post(url, payload);\n};\nconst put2 = (url, payload) => {\n  var client = new Client();\n  return client.put(url, payload);\n};\n/**\n *\n */\nexport const me = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me\");\n};\nexport const myGroups = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me/memberOf\");\n};\nexport const MyTeams = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me/joinedTeams\");\n};\n\nexport const MyTeam = (id) => {\n  return get2(\"https://graph.microsoft.com/v1.0/teams/\"+id);\n};\n\n\nexport const readTeam = (id) => {\n  return get2(\"https://graph.microsoft.com/v1.0/groups/\" + id);\n};\n\nexport const readTeamChannelMessages = (groupId,channelId) => {\n  return get2(`https://graph.microsoft.com/beta/teams/${groupId}/channels/${channelId}/messages`,{\n    skipNextLink:true\n  \n  });\n};\n\n\nexport const getMyExtention = (extensionName) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`\n  );\n};\n\nexport const getOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}`\n  );\n};\nexport const getOneDriveFolderContent = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}:/children`\n  );\n};\n\nexport const getOneDriveFile = (folderNameWithOutInitialSlash, filename) => {\n  return new Promise(async (resolve, reject) => {\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    get2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}`\n    )\n      .then((file) => {\n        axios\n          .get(file[\"@microsoft.graph.downloadUrl\"])\n          .then((response) => {\n            resolve(response.data);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const saveOneDriveFile = (\n  folderNameWithOutInitialSlash,\n  filename,\n  payload\n) => {\n  return new Promise(async (resolve, reject) => {\n    console.log(\"Size of payload\", payload.length);\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    put2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}:/content`,\n      payload\n    )\n      .then((result) => {\n        resolve(result);\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const createOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root/children`,\n    driveItem\n  );\n};\n\nexport const createOneDriveFolderChild = (\n  parentFolderNameWithOutInitialSlash,\n  folderNameWithOutInitialSlash\n) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${parentFolderNameWithOutInitialSlash}:/children`,\n    driveItem\n  );\n};\n\nexport const saveMyExtention = (extensionName, data) => {\n  return new Promise(async (resolve, reject) => {\n    var existing = await getMyExtention(extensionName).catch((e) => {});\n    if (!existing) {\n      addMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    } else {\n      updateMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    }\n  });\n};\nexport const updateMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return patch2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`,\n    payload\n  );\n};\nexport const addMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return post2(`https://graph.microsoft.com/v1.0/me/extensions`, payload);\n};\n\nexport const teamMemberships = (reportProgessPercent) => {\n  var client = new Client();\n  return new Promise(async (resolve, reject) => {\n    try {\n      var memberships = await client\n        .get(\"https://graph.microsoft.com/v1.0/me/memberOf\")\n        .catch((error) => reject(error));\n      var pending = 0;\n      var groups = [];\n\n      if (!memberships) return reject(\"Not able to read membership\");\n\n      //memberships = [memberships[0]];\n      var total = memberships.length;\n      var processed = 0;\n      if (reportProgessPercent) reportProgessPercent(0);\n      memberships.map(async (value) => {\n        pending++;\n\n        var group = await readGroup(value, client);\n\n        processed++;\n        if (reportProgessPercent) reportProgessPercent(processed / total);\n        groups.push(group);\n\n        pending--;\n        if (pending === 0) {\n          return resolve(\n            groups.sort((a, b) => {\n              if (a.text < b.text) {\n                return -1;\n              }\n              if (a.text > b.text) {\n                return 1;\n              }\n              return 0;\n            })\n          );\n        }\n      });\n    } catch (error) {\n      \n      reject(error);\n    }\n  }, null);\n};\n\nexport var auth = {};\n\nauth.getAccessToken = function () {\n  return storageProvider.getItem(\"access_token\");\n};\n\nfunction readGroup(value, client) {\n  return new Promise(async (resolve, reject) => {\n    var group = {\n      ...value,\n      key: value.id,\n      text: value.title ? value.title : value.displayName,\n      title: value.description,\n    };\n    var photo = await client\n      .getImage(\n        `https://graph.microsoft.com/v1.0/groups/${value.id}/photo/$value`\n      )\n      .catch((error) => {\n        \n        console.log(\"Photo read error\");\n      });\n    if (photo && photo.indexOf(\"data:application/json\") > -1) photo = null;\n\n    var details = await client\n      .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\n      .catch((error) => console.log(\"Team details read error\"));\n    (value.creationOptions ? value.creationOptions : []).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    (value.resourceProvisioningOptions\n      ? value.resourceProvisioningOptions\n      : []\n    ).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    \n    // https://www.techmikael.com/2017/11/retrieving-teams-and-yammer-endpoints.html\n    var channels = await readChannels(client, value).catch((e) => {});\n    var endPoints = await readEndpoints(client, value).catch((e) => {});\n    group.hasTeams = channels !== undefined;\n    group.data = {\n      endPoints,\n      details,\n      photo,\n      channels: channels,\n    };\n    resolve(group);\n  });\n\n}\nexport function readTeamInfoAsGuest(value) {\n  var client = new Client();\n  return new Promise(async (resolve, reject) => {\n    var group = {\n      ...value,\n      key: value.id,\n      text: value.title ? value.title : value.displayName,\n      title: value.description,\n    };\n    // var photo = await client\n    //   .getImage(\n    //     `https://graph.microsoft.com/v1.0/teams/${value.id}/photo/$value`\n    //   )\n    //   .catch((error) => {\n    //     debugger;\n    //     console.log(\"Photo read error\");\n    //   });\n    // if (photo && photo.indexOf(\"data:application/json\") > -1) photo = null;\n\n    var details = await client\n      .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\n      .catch((error) => console.log(\"Team details read error\"));\n    (value.creationOptions ? value.creationOptions : []).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    (value.resourceProvisioningOptions\n      ? value.resourceProvisioningOptions\n      : []\n    ).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    \n    // https://www.techmikael.com/2017/11/retrieving-teams-and-yammer-endpoints.html\n    var channels = await readChannelsAsGuest(client, value).catch((e) => {});\n    var endPoints = await readEndpoints(client, value).catch((e) => {});\n    group.hasTeams = channels !== undefined;\n    group.data = {\n      endPoints,\n      details,\n     // photo,\n      channels: channels,\n    };\n    resolve(group);\n  });\n}\nasync function readChannels(client, value) {\n  var queue = 0;\n  return new Promise(async (resolve, reject) => {\n    var channels = await client\n      .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\n      .catch((error) => {\n        console.log(\"Channel read error\");\n      });\n    if (!channels) return resolve();\n\n    channels.forEach(async (channel) => {\n      queue++;\n      var tabs = await client\n        .get(\n          `https://graph.microsoft.com/beta/teams/${value.id}/channels/${channel.id}/tabs`\n        )\n        .catch((error) => {\n          console.log(\"Channel read tabs\", error);\n        });\n\n      channel.tabs = tabs;\n      queue--;\n      if (queue === 0) {\n        resolve(channels);\n      }\n    });\n  });\n}\nasync function readChannelsAsGuest(client, value) {\n  var queue = 0;\n  return new Promise(async (resolve, reject) => {\n    var channels = await client\n      .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\n      .catch((error) => {\n        console.log(\"Channel read error\");\n      });\n    if (!channels) return resolve();\n    resolve(channels);\n    // channels.forEach(async (channel) => {\n    //   queue++;\n    //   var tabs = await client\n    //     .get(\n    //       `https://graph.microsoft.com/v1.0/chats/${channel.id}`\n    //     )\n    //     .catch((error) => {\n    //       console.log(\"Channel read chat members\", error);\n    //     });\n\n    //   channel.tabs = tabs;\n    //   queue--;\n    //   if (queue === 0) {\n    //     resolve(channels);\n    //   }\n    // });\n  });\n}\n\nasync function readEndpoints(client, value) {\n  return client.get(\n    `https://graph.microsoft.com/beta/groups/${value.id}/endpoints`\n  );\n}\n\nfunction post(token, url, body, cb) {\n  axios\n    .post(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction patch(token, url, body, cb) {\n  axios\n    .patch(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction put(token, url, body, cb) {\n  axios\n    .put(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\nexport function getRaw(token, url) {\n  console.log(\"getting\", url);\n\n  return new Promise((resolve, reject) => {\n    request.get(\n      {\n        url: url,\n        headers: {\n          authorization: \"Bearer \" + token,\n        },\n      },\n      function (err, response, body) {\n        if (err) {\n          return reject(err);\n        }\n        resolve({ body, response });\n      }\n    );\n  });\n}\n\nfunction getImage(token, url) {\n  return new Promise((resolve, reject) => {\n    try {\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(xhr.response);\n      };\n\n      xhr.open(\"GET\", url);\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n      xhr.responseType = \"blob\";\n      xhr.send();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function get(token, url, cb, appendTo, index, retrycount,options) {\n  console.log(\"getting\", url, appendTo === true);\n  request.get(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        var errCounter = retrycount ? retrycount + 1 : 1;\n        if (errCounter > 3) {\n          return cb(err, null, index);\n        } else {\n          // retry\n          console.log(\"retry #\", errCounter);\n          return get(token, url, cb, appendTo, index, errCounter);\n        }\n      }\n\n      parsedBody = JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(parsedBody.error, null, index);\n      }\n\n    \n      if (parsedBody[\"@odata.nextLink\"]) {\n        \n        var followNextLink = options && options.skipNextLink ? false:true \n        var data;\n        if (!appendTo) {\n          data = parsedBody.value;\n        } else {\n          data = appendTo.concat(parsedBody.value);\n        }\n        if (followNextLink){\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\n      }\n      }\n\n      if (appendTo) {\n        cb(null, appendTo.concat(parsedBody.value), index);\n      } else {\n        if (parsedBody.value) {\n          cb(null, parsedBody.value, index);\n        } else {\n          cb(null, parsedBody, index);\n        }\n      }\n    }\n  );\n}\n","import {\n  me,\n  myGroups,\n  MyTeams,\n  readTeam,\n  getMyExtention,\n  saveMyExtention,\n  getOneDriveFolder,\n  createOneDriveFolder,\n  getOneDriveFolderContent,\n  createOneDriveFolderChild,\n  getOneDriveFile,\n  saveOneDriveFile,\n} from \"./OfficeGraph\";\n\nimport projectInfo from \"../../package.json\";\nimport _ from \"lodash\";\nimport Axios from \"axios\";\nexport const extentionName = \"com.ztickybar.tools\";\nexport const OURPATH = \"Apps/jumpto365.com\";\nexport const BOARDSPATH = \"Apps/jumpto365.com/boards\";\nexport const BOARDS = \"boards\";\n\nexport const OURCONFIGFILENAME = \"launchpad.json\";\nexport const BOARDINDEXFILENAME = \"index-contexts.json\";\n\nexport function saveCache(memberships) {\n  return new Promise((resolve, reject) => {\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(OURPATH, cachedFileName(membership.id), membership).then(\n        () => {\n          queue--;\n          if (queue < 1) {\n            saveOneDriveFile(OURPATH, \"memberships.json\", membershipIndex)\n              .then(() => {\n                resolve(membershipIndex);\n              })\n              .catch((e) => {\n                reject(e);\n              });\n          }\n        }\n      );\n    });\n  });\n}\n\nfunction cachedFileName(id) {\n  return \"membership.\" + id + \".json\";\n}\n\nexport function readCache() {\n  return new Promise(async (resolve, reject) => {\n    var membershipIndex = await getOneDriveFile(\n      OURPATH,\n      \"memberships.json\"\n    ).catch((e) => {\n      reject(e);\n    });\n    if (!membershipIndex) return;\n    var queue = 0;\n    var memberships = [];\n    membershipIndex.forEach((id) => {\n      queue++;\n      getOneDriveFile(OURPATH, cachedFileName(id))\n        .then((data) => {\n          memberships.push(data);\n          queue--;\n          if (queue < 1) {\n            resolve(memberships);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\n\n/**\n * Verifies access to all endpoints used for the LaunchPad app\n *\n * @param {*} setCheckMe Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMyExtention  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDrive  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDriveFiles  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMemberships  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckTeam  Callback accepting a string - \"OK\" or an error\n */\nexport async function verifyAccessForLanuchPad(\n  setCheckMe,\n  setCheckMyExtention,\n  setCheckOneDrive,\n  setCheckOneDriveFiles,\n  setCheckMemberships,\n  setCheckTeam\n) {\n  me()\n    .then((m) => {\n      setCheckMe(\"OK\");\n    })\n    .catch((e) => {\n      setCheckMe(e.message);\n    });\n\n  var extention = await saveMyExtention(extentionName, {\n    hello: \"world\",\n  }).catch((e) => {\n    setCheckMyExtention(e.message);\n  });\n  if (extention || extention === \"\") {\n    setCheckMyExtention(\"OK\");\n  }\n\n  getOneDriveFolder(OURPATH)\n    .then((r) => {\n      setCheckOneDrive(\"OK\");\n      checkAccessToConfig();\n    })\n    .catch(async (e) => {\n      var f = await getOneDriveFolder(\"Apps\").catch((e) => {});\n      if (f) {\n        var child = await createOneDriveFolderChild(\n          \"Apps\",\n          \"jumpto365.com\"\n        ).catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      } else {\n        var child = await createOneDriveFolder(\"Apps\").catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        child = await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\").catch(\n          (e) => {\n            setCheckOneDrive(e.message);\n          }\n        );\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      }\n    });\n\n  MyTeams()\n    .then((memberships) => {\n      setCheckMemberships(\"OK\");\n      var teamId;\n      memberships.forEach((member) => {\n        if (member.displayName) {\n          if (!teamId) {\n            teamId = member.id;\n          }\n        }\n      });\n      if (teamId) {\n        readTeam(teamId)\n          .then((m) => {\n            setCheckTeam(\"OK\");\n          })\n          .catch((e) => {\n            setCheckTeam(e.message);\n          });\n      } else {\n        setCheckTeam(\"Didn't find any Microsoft Teams memberships\");\n      }\n    })\n    .catch((e) => {\n      setCheckMemberships(e.message);\n    });\n\n  async function checkAccessToConfig() {\n    var settings = await getOneDriveFile(OURPATH, OURCONFIGFILENAME).catch(\n      async (e) => {\n        var file = await saveOneDriveFile(OURPATH, OURCONFIGFILENAME, {\n          version: projectInfo.version,\n        }).catch((e) => {\n          setCheckOneDriveFiles(e.message);\n        });\n        if (file) {\n          setCheckOneDriveFiles(\"OK\");\n        }\n      }\n    );\n    if (settings) {\n      setCheckOneDriveFiles(\"OK\");\n      checkAccessToContexts();\n    }\n  }\n}\n\nexport async function checkAccessToContexts() {\n  await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\");\n  await createOneDriveFolderChild(OURPATH, BOARDS);\n}\n\nexport function saveBoard(memberships, name) {\n  return new Promise(async (resolve, reject) => {\n    await createOneDriveFolderChild(BOARDSPATH, name);\n    var currentBoardPath = BOARDSPATH + \"/\" + name;\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(\n        currentBoardPath,\n        cachedFileName(membership.id),\n        membership\n      ).then(() => {\n        queue--;\n        if (queue < 1) {\n          saveOneDriveFile(\n            currentBoardPath,\n            \"memberships.json\",\n            membershipIndex\n          )\n            .then(() => {\n              resolve(membershipIndex);\n            })\n            .catch((e) => {\n              reject(e);\n            });\n        }\n      });\n    });\n  });\n}\n\nexport function readBoard(name) {\n  return new Promise(async (resolve, reject) => {\n    var currentBoardPath = BOARDSPATH + \"/\" + name;\n    var membershipIndex = await getOneDriveFile(\n      currentBoardPath,\n      \"memberships.json\"\n    ).catch((e) => {\n      reject(e);\n    });\n    if (!membershipIndex) return;\n    var queue = 0;\n    var memberships = [];\n    membershipIndex.forEach((id) => {\n      queue++;\n      getOneDriveFile(currentBoardPath, cachedFileName(id))\n        .then((data) => {\n          memberships.push(data);\n          queue--;\n          if (queue < 1) {\n            resolve(memberships);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\n\nvar buffer = {\n  layouts: { pending: false },\n};\n\nfunction delaywriteLayouts() {\n  setTimeout(() => {\n    console.log(\"delaywriteLayouts\");\n    if (!buffer.layouts.pending) {\n      return;\n    }\n    if (buffer.layouts.writing) {\n      return delaywriteLayouts();\n    }\n    writeLayouts(\n      buffer.layouts.folder,\n      buffer.layouts.file,\n      buffer.layouts.data\n    );\n  }, 2000);\n}\n\nexport function writeLayouts(folder, file, data) {\n  // if (data.myTeams.length === 0) {\n  //   console.log(\"Ignoring writeLayouts with no teams\")\n  //   return}\n  return new Promise(async (resolve, reject) => {\n    console.log(\"writeLayouts\");\n    if (buffer && buffer.layouts && buffer.layouts.writing) {\n      if (_.isEqual(buffer.layouts.data, data)) {\n        console.log(\"writeLayouts no changes\");\n        return resolve();\n      }\n      buffer.layouts.pending = true;\n      buffer.layouts.data = data;\n      buffer.layouts.file = file;\n      buffer.layouts.folder = folder;\n      delaywriteLayouts();\n      return resolve();\n    }\n\n    try {\n      buffer.layouts.writing = true;\n      buffer.layouts.current = data;\n\n      await saveOneDriveFile(folder, file, data);\n      buildIndexOfLaunzhBoards();\n      resolve();\n    } catch (error) {\n      console.log(\"writeLayouts > error\", error);\n      return reject(error);\n    } finally {\n      buffer.layouts.writing = false;\n    }\n  });\n}\n\nexport function readLayouts(folder, file) {\n  return getOneDriveFile(folder, file);\n}\n\nexport function readBoardFiles() {\n  return getOneDriveFolderContent(BOARDSPATH);\n}\n\nexport function readBoards() {\n  return new Promise(async (resolve, reject) => {\n    var files = await getOneDriveFolderContent(BOARDSPATH).catch((e) => {\n      reject(e);\n    });\n    if (!files) return; // rejected in catch - hopefully (-;\n\n    var pending = 0;\n    var results = [];\n    files.forEach((file) => {\n      pending++;\n      Axios.get(file[\"@microsoft.graph.downloadUrl\"])\n        .then((result) => {\n          pending--;\n          results.push({\n            file,\n            content: result.data,\n          });\n          if (pending < 1) {\n            resolve(results);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\nexport function teamsLink(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/team/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return null;\n  }\n}\nexport function teamsLink2(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/channel/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return null;\n  }\n}\nexport function getHref(team) {\n  var href =\n    team && team.data && team.data.details ? team.data.details.webUrl : \"\";\n  if (team.data) {\n    var uniqueEndPoints = _.groupBy(\n      team.data.endPoints ? team.data.endPoints : [],\n      (endPoint) => {\n        return endPoint.providerName;\n      }\n    );\n  }\n  var conversationsHref =\n    team && team.tile\n      ? team.tile.jumpto\n        ? team.tile.jumpto\n        : team.tile.externalArticle\n      : uniqueEndPoints[\"Yammer\"]\n      ? uniqueEndPoints[\"Yammer\"][0].uri\n      : teamsLink(href);\n\n  return conversationsHref;\n}\n\n/**\n * Read all context for a given user and build an index of where a given URL is found\n */\nexport function buildIndexOfLaunzhBoards() {\n  return new Promise(async (resolve, reject) => {\n    var index = {};\n    var ctxs = await readBoards();\n\n    ctxs.forEach((ctx) => {\n      try {\n        var fullname = ctx.file.name.split(\".\");\n        var name = fullname ? fullname[0] : ctx.file.name;\n\n        ctx.content.myTeams.forEach((team) => {\n          var href = getHref(team);\n          if (!index[href]) {\n            index[href] = [\n              { name, color: \"#000000\", backgroundColor: \"#b3e6a9\" },\n            ];\n          } else {\n            index[href].push({\n              name,\n              color: \"#000000\",\n              backgroundColor: \"#b3e6a9\",\n            });\n          }\n        });\n      } catch (error) {\n        console.log(\"indexLaunzhContexts\", error);\n      }\n    });\n    await saveOneDriveFile(OURPATH, BOARDINDEXFILENAME, index);\n  });\n}\n\nexport function readIndexOfLaunzhBoards() {\n  return getOneDriveFile(OURPATH, BOARDINDEXFILENAME);\n}\n","import React, {\n  Component,\n  useState,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n} from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Highlight } from \"./Highlight\";\nimport Masonry from \"react-masonry-css\";\nimport moment from \"moment\";\nimport \"./masonry.css\";\nimport { GroupMouseOver, PinMouseOver } from \"./MouseOver\";\nimport _ from \"lodash\";\nimport { EVENT, trace } from \"../helpers/trace\";\n\nimport { getHref, teamsLink, teamsLink2 } from \"../helpers/LaunchPad\";\nimport \"./tile.css\";\nimport { navigate } from \"@reach/router\";\nimport { ActionButton, Button, IconButton } from \"@fluentui/react\";\nimport { readTeamChannelMessages } from \"../helpers/OfficeGraph\";\nconst breakpointColumnsObj = {\n  default: 11,\n\n  3600: 11,\n\n  3300: 10,\n  3000: 9,\n  2700: 8,\n  2400: 7,\n\n  2100: 6,\n  1800: 5,\n  1500: 4,\n  1200: 3,\n  900: 2,\n  600: 1,\n  //300: 1,\n};\nexport const useContainerDimensions = (myRef) => {\n  const getDimensions = () => ({\n    width: myRef.current.offsetParent.offsetWidth,\n    height: myRef.current.offsetParent.offsetHeight,\n  });\n\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n\n  useEffect(() => {\n    if (myRef.current) {\n      setDimensions(getDimensions());\n    }\n  }, []);\n\n  return dimensions;\n};\nexport const ViewTeams = (props) => {\n  const [viewChannels, setViewChannels] = useState(props.details);\n  const [viewDates, setViewDates] = useState(false);\n\n  if (props && props.memberShips) {\n    var memberShips = _.cloneDeep(props.memberShips);\n\n    if (props.tiles) {\n      props.tiles.forEach((tile) => {\n        //debugger\n        memberShips.push({\n          displayName: tile.title,\n          tile,\n        });\n      });\n\n      memberShips = _.sortBy(memberShips, [\"displayName\"]);\n    }\n    return (\n      <div\n        className=\"tags\"\n        style={{\n          padding: \"4px\",\n          margin: \"4px\",\n          fontSize: \"16px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          minWidth: \"300px\",\n        }}\n      >\n        <Masonry\n          breakpointCols={breakpointColumnsObj}\n          className=\"my-masonry-grid\"\n          columnClassName=\"my-masonry-grid_column\"\n        >\n          {/* array of JSX items */}\n\n          {memberShips.map((team, key) => {\n            //    if ((!team.resourceProvisioningOptions || !team.resourceProvisioningOptions.length > 0) && (team.creationOptions && !team.creationOptions.length > 0)) return null\n            //if ( team[\"@odata.type\"] === \"#microsoft.graph.directoryRole\") return null\n            // Profoe: \"https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=profile\"\n\n            return (\n              <ViewTeam\n                {...props}\n                key={key}\n                team={team}\n                viewChannels={props.details}\n                viewDates={viewDates}\n                onSaveTeam={props.onSaveTeam}\n              />\n            );\n          })}\n        </Masonry>\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\n\nexport function ViewTeam(props) {\n\n  function logo(show, icon) {\n    if (!show) return null;\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\n  }\n\n  const team = props.team ? props.team : {};\n  var photo = team.data ? team.data.photo : null;\n\n  return (\n    <div>\n    {photo && (\n      <div>\n\n      <div\n\n        className=\"pinnedTile2\"\n        style={{\n          color:\"#ffffff\",\n          backgroundColor: \"#3f418e\",\n          minWidth: \"48px\",\n        }}\n      >\n      <img\n      src={\"https://blob.jumpto365.com/images/h/e/x/hexatown.com/m/matt@hexatown.com/2019/09/Microsoft_Teams_256x256.png-20190920-092147.png\"}\n      style={{\n        margin: \"12px\",\n        height: \"24px\",\n        width: \"24px\",\n      }}\n    ></img>{team.text}\n  </div>\n      \n    </div>\n\n\n\n    )}\n    {team.tile && team.tile.icon && (\n      <div\n        className=\"pinnedTile2\"\n        style={{\n          color:\"#ffffff\",\n          backgroundColor: team.tile.color,\n          minWidth: \"48px\",\n        }}\n      >\n        <img\n          src={team.tile.icon}\n          style={{\n            margin: \"12px\",\n            height: \"24px\",\n            width: \"24px\",\n          }}\n        ></img>{team.tile.title}\n      </div>\n    )}\n\n    </div>\n  );\n}\nexport function ViewTeamOLD(props) {\n  const viewChannels = props.viewChannels;\n  const [viewDates, setViewDates] = useState(props.viewDates);\n  const [mouseOver, setMouseOver] = useState(false);\n  const componentRef = useRef();\n\n  const team = props.team ? props.team : {};\n\n  function logo(show, icon) {\n    if (!show) return null;\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\n  }\n\n  // Notebook https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=notebook\"\n  // Planner \"https://tasks.office.com/365adm.onmicrosoft.com/en-US/Home/Group/786dc6d7-766f-46df-ac4b-d6883597061f\"\n\n  var conversationsHref = getHref(team);\n\n  var details =\n    team.data && team.data.details\n      ? team.data.details\n      : {\n          displayName: team.title\n            ? team.title\n            : team.displayName\n            ? team.displayName\n            : team[\"@odata.type\"],\n        };\n  var photo = team.data ? team.data.photo : null;\n  var channels = team.data && team.data.channels ? team.data.channels : [];\n\n  if (props.isPinned) {\n    //const { width, height } = useContainerDimensions(componentRef,props.refreshCount)\n    var width = componentRef.current\n      ? componentRef.current.offsetParent.offsetWidth - 2\n      : 0;\n    var height = componentRef.current\n      ? componentRef.current.offsetParent.offsetHeight - 2\n      : 0;\n\n    return (\n      <div\n        ref={componentRef}\n        className=\"pinnedTile\"\n        style={{ position: \"relative\", pointer: \"default\" }}\n        onClick={() => {\n          if (!props.editMode) {\n          }\n        }}\n      >\n        <div\n          style={{ position: \"absolute\", right: 4, top: 4, display: \"flex\" }}\n        >\n          <div>\n            {logo(team.hasTeams, \"TeamsLogo\")}\n            {logo(team.hasSharePoint, \"SharepointLogo\")}\n            {logo(team.hasYammer, \"YammerLogo\")}\n          </div>\n        </div>\n        <div\n          style={{\n            position: \"absolute\",\n            right: 10,\n            bottom: 4,\n            display: \"flex\",\n          }}\n        >\n          {\" \"}\n          <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n        </div>\n        <div\n          style={{ display: \"flex\" }}\n          onMouseEnter={() => {\n            setMouseOver(true);\n          }}\n          onMouseLeave={() => {\n            setMouseOver(false);\n          }}\n          style={{\n            width,\n            height,\n            xborder: \"1px dashed red\",\n            xborderRadius: \"20px\",\n          }}\n        >\n          <div style={{ display: \"flex\" }}>\n            <div>\n              {props.editMode && mouseOver && (\n                <div style={{ position: \"absolute\", right: \"0\" }}>\n                  {\" \"}\n                  <span\n                    className=\"ms-Icon ms-Icon--Delete tiledelete\"\n                    onClick={() => {\n                      if (props.onRemovePin) {\n                        props.onRemovePin(props.pinId);\n                      }\n                    }}\n                  ></span>\n                </div>\n              )}\n              {!props.editMode && mouseOver && (\n                <div style={{ position: \"absolute\", right: \"0\" }}>\n                  {\" \"}\n                  <span\n                    className=\"ms-Icon ms-Icon--OpenInNewWindow tileopen \"\n                    onClick={() => {\n                      window.open(conversationsHref);\n                    }}\n                  ></span>\n                </div>\n              )}\n\n              {/* {width}x{height} - {props.width}x{props.height} {props.refreshCounter} */}\n              {photo && (\n                <div className=\"\" style={{ minWidth: \"48px\" }}>\n                  <img\n                    className=\"pinnedTile2\"\n                    src={photo}\n                    style={{\n                      height: \"48px\",\n                      width: \"48px\",\n                    }}\n                  ></img>\n                </div>\n              )}\n              {team.tile && team.tile.icon && (\n                <div\n                  className=\"pinnedTile2\"\n                  style={{\n                    backgroundColor: team.tile.color,\n                    minWidth: \"48px\",\n                  }}\n                >\n                  <img\n                    src={team.tile.icon}\n                    style={{\n                      margin: \"12px\",\n                      height: \"24px\",\n                      width: \"24px\",\n                    }}\n                  ></img>\n                </div>\n              )}\n            </div>\n            <div\n              className=\"ms-font-xl \"\n              style={{\n                padding: \"8px\",\n                marginRight: \"20px\",\n                lineHeight: \"32px\",\n                flexGrow: 1,\n              }}\n            >\n              {team.displayName}\n              {team.channel && (\n                <div className=\"channelListing\">\n                  <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\n                    <TeamChannel\n                      team={team}\n                      viewMode\n                      channel={team.channel}\n                      details={true}\n                    />\n                  </ul>{\" \"}\n                </div>\n              )}\n            </div>\n          </div>\n          {mouseOver && (\n            <ListTags\n              indexLaunzhContexts={props.indexLaunzhContexts}\n              href={conversationsHref}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n  if (team.tile) {\n    return (\n      <div\n        onMouseEnter={() => {\n          setMouseOver(true);\n        }}\n        onMouseLeave={() => {\n          setMouseOver(false);\n        }}\n        style={{\n          paddingLeft: \"0px\",\n          margin: \"10px\",\n          fontSize: \"16px\",\n          xdisplay: \"flex\",\n          border: \"1px solid #dddddd\",\n          minWidth: \"290px\",\n          maxWidth: \"290px\",\n        }}\n      >\n        <span\n          onClick={() => {\n            trace(EVENT.TILECLICKED, {\n              \"tile-key\": team.tile.key,\n              href: team.tile.externalArticle,\n            });\n          }}\n        >\n          <a\n            className=\"TeamLink\"\n            href={team.tile.externalArticle}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <div>\n              <div\n                style={{\n                  minWidth: \"288px\",\n                  paddingLeft: \"0px\",\n                  paddingBottom: \"0px\",\n                  position: \"relative\",\n                }}\n              >\n                {mouseOver && (\n                  <div\n                    style={{\n                      position: \"absolute\",\n                      right: \"10px\",\n                      top: \"10px\",\n                      zIndex: \"1\",\n                      backgroundColor: \"#ffffffcc\",\n                    }}\n                  >\n                    <ActionButton\n                      styles={{ fontSize: \"24px\" }}\n                      iconProps={{ iconName: \"Save\" }}\n                      ariaLabel=\"Save\"\n                      onClick={(event) => {\n                        if (props.onSaveTeam) {\n                          event.preventDefault(); // Let's stop this event.\n                          event.stopPropagation(); // Really this time.\n                          props.onSaveTeam(team);\n                        }\n                      }}\n                    >\n                      Save Tile\n                    </ActionButton>\n                  </div>\n                )}\n                {team.tile.icon && (\n                  <div\n                    className=\"teamTitleBar\"\n                    style={{\n                      backgroundColor: team.tile.color,\n                      marginTop: \"-20px\",\n                      minWidth: \"280px\",\n                    }}\n                  >\n                    <img\n                      src={team.tile.icon}\n                      style={{\n                        margin: \"70px\",\n                        height: \"140px\",\n                        width: \"140px\",\n                      }}\n                    ></img>\n                  </div>\n                )}\n              </div>\n              <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n                <div\n                  className=\"ms-font-xl \"\n                  style={{\n                    padding: \"8px\",\n                    lineHeight: \"32px\",\n                    textAlign: \"center\",\n                  }}\n                >\n                  <Highlight\n                    text={team.tile.title}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            </div>\n\n            {team.tile.inShort && (\n              <div\n                className=\"ms-font-m\"\n                style={{\n                  fontStyle: \"italic\",\n                  marginTop: \"10px\",\n                  paddingLeft: \"20px\",\n                  paddingRight: \"20px\",\n                  margin: \"0px\",\n                }}\n              >\n                <div style={{ fontStyle: \"italic\", marginTop: \"8px\" }}>\n                  <Highlight\n                    text={team.tile.inShort}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            )}\n          </a>\n        </span>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      onMouseEnter={() => {\n        setMouseOver(true);\n      }}\n      onMouseLeave={() => {\n        setMouseOver(false);\n      }}\n      style={{\n        paddingLeft: \"0px\",\n        margin: \"10px\",\n        fontSize: \"16px\",\n        xdisplay: \"flex\",\n        border: \"1px solid #dddddd\",\n        minWidth: \"290px\",\n        maxWidth: \"290px\",\n      }}\n    >\n      <div>\n        <div\n          style={{\n            minWidth: \"290px\",\n            paddingLeft: \"0px\",\n            paddingBottom: \"0px\",\n            position: \"relative\",\n          }}\n        >\n          {mouseOver && (\n            <div\n              style={{\n                position: \"absolute\",\n                right: \"10px\",\n                top: \"10px\",\n                zIndex: \"1\",\n                backgroundColor: \"#ffffffcc\",\n              }}\n            >\n              <ActionButton\n                styles={{ fontSize: \"24px\" }}\n                iconProps={{ iconName: \"Save\" }}\n                ariaLabel=\"Save\"\n                onClick={(event) => {\n                  if (props.onSaveTeam) {\n                    event.preventDefault(); // Let's stop this event.\n                    event.stopPropagation(); // Really this time.\n                    props.onSaveTeam(team);\n                  }\n                }}\n              >\n                Save Tile\n              </ActionButton>\n            </div>\n          )}\n          {photo && (\n            <img\n              className=\"teamImage\"\n              src={photo}\n              style={{\n                height: \"288px\",\n                width: \"288px\",\n                marginLeft: \"0px\",\n              }}\n            ></img>\n          )}\n        </div>\n        <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n          <div\n            className=\"ms-font-xl \"\n            style={{\n              padding: \"8px\",\n              lineHeight: \"32px\",\n              textAlign: \"center\",\n            }}\n          >\n            <Highlight\n              text={details.displayName}\n              filter={props.filter}\n              style={props.highlightStyle}\n            />\n          </div>\n        </div>\n        <div style={{ border: \"0px solid #dddddd\", paddingBottom: \"4px\" }}>\n          <div\n            style={{\n              display: \"flex\",\n              marginRight: \"10px\",\n              marginLeft: \"10px\",\n              marginTop: \"10px\",\n            }}\n          >\n            <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n            <div>\n              {logo(team.hasTeams, \"TeamsLogo\")}\n              {logo(team.hasSharePoint, \"SharepointLogo\")}\n              {logo(team.hasYammer, \"YammerLogo\")}\n            </div>\n          </div>\n\n          {/* {team.data.endPoints && \n              team.data.endPoints.map((endPoint, key) => {\n             // if (endPoint.providerName===\"Yammer\") debugger\n              return <div key={key}><a target=\"_blank\" href={endPoint.uri}>{endPoint.providerName} ({endPoint.capability})</a></div>;\n              })} */}\n        </div>\n      </div>\n      {details.displayName !== details.description && (\n        <div\n          className=\"ms-font-m\"\n          style={{\n            fontStyle: \"italic\",\n            marginTop: \"10px\",\n            paddingLeft: \"20px\",\n            paddingRight: \"20px\",\n            margin: \"0px\",\n          }}\n        >\n          {details.description}\n        </div>\n      )}\n      {viewChannels && (\n        <div className=\"ms-font-l ms-fontWeight-bold\">\n          {channels.length > 1 && (\n            <div style={{ marginTop: \"10px\", marginLeft: \"20px\" }}>\n              Channels\n            </div>\n          )}\n          <div className=\"channelListing\">\n            <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\n              {channels.map((channel, key) => {\n                if (channel.displayName === \"$General\") {\n                  return null;\n                }\n                return (\n                  <TeamChannel\n                    {...props}\n                    noMessages\n                    key={key}\n                    channel={channel}\n                    details={details}\n                  />\n                );\n              })}\n            </ul>\n          </div>\n        </div>\n      )}\n      <div>\n        {viewDates && (\n          <div style={{ display: \"xflex\" }}>\n            {team.expirationDateTime && (\n              <div style={{ flexGrow: 1 }}>\n                Expires in {moment(team.expirationDateTime).fromNow(true)}\n              </div>\n            )}\n            {/* {team.renewedDateTime && (<div style={{ flexGrow: 1 }}>\n                     Renewed {moment(team.renewedDateTime).toNow(true)} a go\n          </div>)} */}\n          </div>\n        )}{\" \"}\n      </div>\n    </div>\n  );\n}\nfunction Messages(props) {\n  if (!props.messages) return null;\n\n  return (\n    <div style={{ overflow: \"auto\", height: \"200px\" }}>\n      {_.orderBy(props.messages, [\"createdDateTime\"], [\"desc\"]).map(\n        (message, key) => {\n          var show =\n            message.body && message.body.content && message.body.content !== \"\"\n              ? true\n              : false;\n\n          if (!show) return null;\n\n          if (\n            message.from &&\n            message.from.user &&\n            message.from.user.displayName &&\n            _.startsWith(message.from.user.displayName, \"orgid:\")\n          ) {\n            return null;\n          }\n\n          var html = { __html: message.body.content };\n          return (\n            <div key={key}>\n              <a\n                href={message.webUrl}\n                target=\"_blank\"\n                style={{ color: \"inherit\", textDecoration: \"none\" }}\n              >\n                {message.from && message.from.user && (\n                  <div>\n                    <div>\n                      <b>\n                        {message.from.user.displayName} (\n                        {moment(message.createdDateTime).fromNow()})\n                      </b>\n                    </div>\n                  </div>\n                )}\n                <div dangerouslySetInnerHTML={html}></div>\n              </a>\n            </div>\n          );\n        }\n      )}\n    </div>\n  );\n}\nfunction TeamChannel(props) {\n  useEffect(() => {\n    async function load() {\n      if (!props.noMessages && props.team && props.channel) {\n        var _messages = await readTeamChannelMessages(\n          props.team.id,\n          props.channel.id\n        ).catch(() => {});\n        setMessages(_messages);\n      }\n    }\n    load();\n  }, [props.team, props.channel]);\n  const [mouseOver, setMouseOver] = useState(false);\n  const [messages, setMessages] = useState(null);\n\n  var channel = props.channel ? props.channel : {};\n\n  var details = props.details ? props.details : {};\n  var team = props.team ? props.team : {};\n\n  return (\n    <li\n      key={props.key}\n      className={`ms-font-m ${props.viewMode ? \"\" : \"teamchannelSelectMode\"} `}\n      onMouseEnter={() => {\n        setMouseOver(true);\n      }}\n      onMouseLeave={() => {\n        setMouseOver(false);\n      }}\n    >\n      <div\n        style={{\n          color: channel.membershipType === \"private\" ? \"red\" : \"#000000\",\n        }}\n      >\n        {mouseOver && !props.viewMode && (\n          <div\n            style={{\n              position: \"relative\",\n            }}\n          >\n            <div\n              style={{\n                position: \"absolute\",\n                right: \"4px\",\n                top: \"4px\",\n                zIndex: \"1\",\n              }}\n            >\n              <IconButton\n                styles={{ fontSize: \"24px\" }}\n                iconProps={{ iconName: \"Save\" }}\n                ariaLabel=\"Save\"\n                onClick={(event) => {\n                  if (props.onSaveChannel) {\n                    event.preventDefault(); // Let's stop this event.\n                    event.stopPropagation(); // Really this time.\n                    props.onSaveChannel(team, channel);\n                  }\n                }}\n              />\n            </div>{\" \"}\n          </div>\n        )}\n        <Highlight\n          text={channel.displayName}\n          filter={props.filter}\n          style={props.highlightStyle}\n        />\n      </div>\n      {channel.description && (\n        <div style={{ fontSize: \"smaller\", fontStyle: \"italic\" }}>\n          <Highlight\n            text={channel.description}\n            filter={props.filter}\n            style={props.highlightStyle}\n          />\n        </div>\n      )}\n      {channel.tabs && (\n        <div className=\"channelTabs\">\n          <ul>\n            <li>\n              {\" \"}\n              <span\n                onClick={() => {\n                  trace(EVENT.TABCLICKED, {\n                    \"team-name\": details.displayName,\n                    \"channel-name\": channel.displayName,\n                    href: channel.filesLink,\n                  });\n                }}\n              >\n                <a href={channel.generalLink} target=\"_blank\">\n                  General\n                </a>\n              </span>\n            </li>\n            <li>\n              <span\n                onClick={() => {\n                  trace(EVENT.TABCLICKED, {\n                    \"team-name\": details.displayName,\n                    \"channel-name\": channel.displayName,\n                    href: channel.filesLink,\n                  });\n                }}\n              >\n                <a href={channel.filesLink} target=\"_blank\">\n                  Files\n                </a>\n              </span>\n            </li>\n            {_.sortBy(channel.tabs, [\"sortOrderIndex\"]).map((tab, ix) => {\n              return (\n                <li key={ix}>\n                  <span\n                    onClick={() => {\n                      trace(EVENT.TABCLICKED, {\n                        \"team-name\": details.displayName,\n                        \"channel-name\": channel.displayName,\n                        \"tab-name\": tab.displayName,\n                        href: channel.filesLink,\n                      });\n                    }}\n                  >\n                    <a\n                      href={\n                        tab.configuration && tab.configuration.websiteUrl\n                          ? tab.configuration.websiteUrl\n                          : tab.webUrl\n                      }\n                      target=\"_blank\"\n                    >\n                      <Highlight\n                        text={decodeURIComponent(tab.displayName)}\n                        filter={props.filter}\n                        style={props.highlightStyle}\n                      />\n                    </a>\n                  </span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      )}\n      {messages && <Messages messages={messages} />}\n    </li>\n  );\n}\n\nexport function ListTags(props) {\n  //debugger\n  if (!props.indexLaunzhContexts) return null;\n\n  if (!props.indexLaunzhContexts[props.href]) return null;\n  return (\n    <div style={{ margin: \"8px\", position: \"absolute\", bottom: \"0\", right: 0 }}>\n      {props.indexLaunzhContexts[props.href].map((tag, key) => {\n        return (\n          <span\n            onClick={() => {\n              window.location.href = `/board/${tag.name}`;\n            }}\n            className=\"tag\"\n            key={key}\n            style={{ color: tag.color, backgroundColor: tag.backgroundColor }}\n          >\n            #{tag.name}\n          </span>\n        );\n      })}\n    </div>\n  );\n}\n","import React from \"react\";\nimport logo from \"./default/logo_intranets.png\";\n\nexport default {\n  clientId: \"42837fd8-873e-445f-9f83-227549fcd39b\",\n  directoryId: \"79dc228f-c8f2-4016-8bf0-b990b6c72e98\",\n  scopes: \"https://graph.microsoft.com/.default\",\n  title: \"My IntraNets\",\n  logo, \n  options: [],\n  components: {\n    header: (\n      <div style={{ marginTop: \"49px\" }}>\n        <div\n          style={{\n            borderBottom: \"1px solid #cccccc\",\n            position: \"fixed\",\n            backgroundColor: \"#ffffff\",\n            width: \"100vw\",\n            left: 0,\n            top: 0,\n            zIndex: 1\n          }}\n        >\n          <div\n            style={{ display: \"flex\", padding:\"10px\" }}\n          >\n            <div style={{ flexGrow: 1 ,display: \"flex\"}}>\n              <div >\n                <a style={{ color:\"inherit\",textDecoration:\"none\" }}\n                \n                href=\"/\" target=\"_blank\"> <div \n                \n              className=\"ms-font-xl\"\n              style={{\n                fontFamily:'SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,\"Segoe UI Web (West European)\",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;',\n                fontSize: \"16px\",\n                fontWeight:\"600\",\n                marginLeft: \"16px\",\n                marginTop: \"0px\",\n                lineHeight: \"36px\",\n                padding: \"0px\",\n                color: \"333\",\n              }}><img style={{ display:\"xnone\",height: \"36px\", padding: \"6px\",paddingTop:\"0px\",marginRight:\"10px\" }} src={logo} /> \n              \n              Guest Access</div>\n                   \n                </a>\n              </div>\n             \n\n            </div>\n            <div\n              \n              \n            >\n              \n            </div>\n            <div style={{ flexGrow: 1 }}>\n              <div style={{ minWidth: \"150px\" }}>&nbsp;</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ),\n  },\n};\n","export function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\nexport function inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\n\nexport function teamsMeetingUrlFromBody(body){\n//  href=\"https://teams.microsoft.com/l/meetup-join/19%3ameeting_NzYwMTM1ZDktMGIzOS00Nzg5LTg5YzQtZGJmODI1NGU2ZjFj%40thread.v2/0?context=%7b%22Tid%22%3a%22df96b8c9-51a1-40cf-b8b1-4514be8e9668%22%2c%22Oid%22%3a%2258d02ee5-af80-4f81-b144-1734b77c02c9%22%7d\"\n\nvar s1 = body.split('href=\"https://teams.microsoft.com/')\nif (s1.length < 2) return null\nvar s2 = s1[1].split('\"')\nif (s2.length < 2) return null\nreturn (\"https://teams.microsoft.com/\" + s2[0])\n\n}\n","import React from \"react\";\nimport _ from \"lodash\";\nimport \"./BreakPointSelector.css\"\nexport default function BreakPointSelector(props) {\n  var breakPoints = props && props.breakpoints ? _.keys(props.breakpoints) : [];\n\n  return (\n    <div className=\"breakpoints\" style={{ display: \"flex\" }}>\n      {breakPoints.map((breakPoint, key) => {\n        return <div key={key} className={`breakpoint ${breakPoint===props.selected?\"selected\":\"\"}`} \n        \n        onClick={()=>{\n            \n            if (props.onSelect){\n                props.onSelect(breakPoint)\n            }\n        }}\n        >{breakPoint}</div>;\n      })}\n    </div>\n  );\n}\n","import React, { useEffect, useState, useRef } from \"react\";\nimport { Dialog, DialogType, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { hiddenContentStyle, mergeStyles } from 'office-ui-fabric-react/lib/Styling';\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\nimport { ContextualMenu } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { useId, useBoolean } from '@uifabric/react-hooks';\nimport { TextField } from \"@fluentui/react\";\n\nconst dialogStyles = { main: { maxWidth: 450 } };\nconst dragOptions = {\n  moveMenuItemText: 'Move',\n  closeMenuItemText: 'Close',\n  menu: ContextualMenu,\n};\nconst screenReaderOnly = mergeStyles(hiddenContentStyle);\nconst dialogContentProps = {\n  type: DialogType.normal,\n  title: 'Name your board',\n  closeButtonAriaLabel: 'Close',\n  subText: 'Give your board a descriptive name, use 30-40 characters if you like',\n};\n\nexport default function AddBoard(props) {\n    const [hideDialog, setHideDialog] = useState(false);\n    const [name, setName] = useState(\"\");\n  const labelId = useId('dialogLabel');\n  const subTextId = useId('subTextLabel');\n\n\n\n  return (\n    <>\n\n      <Dialog\n        hidden={hideDialog}\n        onDismiss={()=>{setHideDialog(true)}}\n        dialogContentProps={dialogContentProps}\n      \n      >\n       <TextField\n                    autoFocus={false}\n                 \n                    label=\"Name\"\n                    text={name}\n                    onChange={(e, newValue) => {\n                     setName(newValue)\n                    }}\n                    placeholder=\"\"\n                    xiconProps={{ iconName: \"Filter\" }}\n                  />\n        <DialogFooter>\n          <PrimaryButton  text=\"Save\"  disabled={name===\"\"} onClick={()=>{\n              setHideDialog(true)\n              if (props.onAdd){\n\n                props.onAdd(name)\n              }\n          }}/>\n          <DefaultButton  text=\"Cancel\" onClick={()=>{\n              setHideDialog(true)\n              if ( props.onDismiss)\n\n                props.onDismiss()\n              }\n          }\n          \n          />\n        </DialogFooter>\n      </Dialog>\n    </>\n  );\n};\n\n\n\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\n\nimport { TextField, Dropdown, DropdownBase } from \"@fluentui/react\";\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\n\nimport { initializeIcons } from \"@uifabric/icons\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport \"./App.css\";\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport ToolboxLayout, { breakpoints } from \"./components/ToolboxLayout\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeam, ViewTeams } from \"./components/ViewTeams\";\nimport config from \"./config\";\nimport \"./css/normalize.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport \"./css/webflow.css\";\nimport { getSearchParametersFromHRef, inIframe } from \"./helpers\";\nimport {\n  BOARDSPATH,\n  readCache,\n  readLayouts,\n  saveCache,\n  writeLayouts,\n  readBoardFiles,\n  readIndexOfLaunzhBoards,\n} from \"./helpers/LaunchPad\";\nimport { teamMemberships, getOneDriveFolder,myTeams } from \"./helpers/OfficeGraph\";\nimport { EVENT, trace } from \"./helpers/trace\";\n\nimport {\n  CommandBar,\n  getTheme,\n  Coachmark,\n  DirectionalHint,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n  Spinner,\n  Label,\n} from \"office-ui-fabric-react\";\n\nimport { navigate } from \"@reach/router\";\nimport BreakPointSelector from \"./components/BreakPointSelector\";\nimport {\n  MessageBarButton,\n  Link,\n  Stack,\n  StackItem,\n  MessageBar,\n  MessageBarType,\n  ChoiceGroup,\n  IStackProps,\n} from \"office-ui-fabric-react\";\nimport AddBoard from \"./components/AddBoard\";\n\nconst dragOptions = {\n  moveMenuItemText: \"Move\",\n  closeMenuItemText: \"Close\",\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: \"Cancel\" };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n    alignItems: \"stretch\",\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: \"1 1 auto\",\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: \"flex\",\n      alignItems: \"center\",\n      fontWeight: FontWeights.semibold,\n      padding: \"12px 12px 14px 24px\",\n    },\n  ],\n  body: {\n    flex: \"4 4 auto\",\n    padding: \"0 24px 24px 24px\",\n    minWidth: \"95vw\",\n    minHeight: \"90vh\",\n    overflowY: \"hidden\",\n    selectors: {\n      p: { margin: \"14px 0\" },\n      \"p:first-child\": { marginTop: 0 },\n      \"p:last-child\": { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: \"auto\",\n    marginTop: \"4px\",\n    marginRight: \"2px\",\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nvar logSearchTimer;\nvar searchInfo;\n\ninitializeIcons();\n\nlet isOfficeInitialized = false;\nasync function getGraphToken(bootstrapToken) {\n  \n  return \"\";\n}\n/* Render application after Office initializes */\n\n\nif (window.Office){\n  window.Office.initialize = async () => {\n    isOfficeInitialized = true;\n\n  };\n}\n\n\nexport default function App(props) {\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n  const inFrame = inIframe();\n  const searchIconRef = useRef();\n  const [showTabFeature, setThowTabFeature] = useState(\n    config.teamsIntegration || upnIs(config.niels)\n  );\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, _setFilter] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [tiles, setTiles] = useState([]);\n  const [useAuthentication, setUseAuthentication] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [currentTile, setCurrentTile] = useState(null);\n  const [me, setMe] = useState({});\n  const [ztickyFolder, setZtickyFolder] = useState({});\n  var [myTools, setMyTools] = useState([]);\n  const [myTeams, setMyTeams] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [tileSize, setTileSize] = useState(1);\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [contexts, setContexts] = useState([]);\n  const [selectedBoard, setSelectedBoard] = useState(props.board);\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [progressPercent, setProgressPercent] = useState(null);\n  const [showTable, setShowTable] = useState(false);\n  const [editingLayout, setEditingLayout] = useState(true);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({\n    lg: [\n      // {\n      //   x: 0,\n      //   y: Infinity,\n      //   w: 3,\n      //   h: 3,\n      //   i: \"1\",\n      //   static: 0, //Math.random() < 0.05,\n      // },\n    ],\n  });\n  const [joinedTeams,setJoinedTeams] =  useState([]);\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\n  const [refreshCounter, setRefreshCounter] = useState(0);\n  const [tags, setTags] = useState([]);\n  const [showDetails, _setShowDetails] = useState(true);\n  const [showCatalogue, _setShowCatalogue] = useState(!inIframe());\n  const [editMode, _setEditMode] = useState(false); //!inIframe());\n  const [isFixedWidth, setIsFixedWidth] = useState(true); //!inIframe());\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [tableApiSelected, setTableApiSelected] = useState(\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\n  );\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\n  const [groups, setGroups] = useState([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedBreakPoint, setSelectedBreakPoint] = useState(\"lg\");\n  const [isMounted, setIsMounted] = useState(false);\n  const [isDirty, setIsDirty] = useState(false);\n  const [showWarning, setShowWarning] = useState(true);\n  const [indexLaunzhContexts, setIndexLaunzhContexts] = useState([]);\n  const [myDrive, setMyDrive] = useState(\"\");\n  const [addingBoard, setAddingBoard] = useState(false);\n  function gotoBoard(boardName) {\n    setSelectedBoard(boardName);\n    window.location.href = `/board/${boardName}`;\n  }\n  function setEditMode(on) {\n    if (on) {\n      setIsDirty(false);\n    }\n    _setEditMode(on);\n  }\n  function setShowDetails(on) {\n    _setShowDetails(on);\n    trace(EVENT.DETAILSTOGGLED, { on });\n  }\n  function setShowCatalogue(on) {\n    _setShowCatalogue(on);\n    setIsModalOpen(true);\n    trace(EVENT.SEARCHCLICKED, { on });\n  }\n\n  function setFilter(value) {\n    setSearch(value);\n    if (_.startsWith(value, \".\")) {\n    } else {\n      _setFilter(value);\n    }\n  }\n\n  const _setTags = (t) => {\n    debugger;\n    setTags(t);\n  };\n\n  const removePin = (pinId) => {\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      layouts[key].splice(pinId, 1);\n\n      layouts[key] = layouts[key].map((m, ix) => {\n        m.i = ix.toString();\n        return m;\n      });\n    });\n\n    myTeams.splice(pinId, 1);\n\n    setLayouts(layouts);\n\n    setMyTeams(myTeams);\n    setRefreshCounter(refreshCounter + 1);\n  };\n\n  const getPin = (id, width, height, refresh) => {\n    var team = myTeams[parseInt(id)];\n    return (\n      <ViewTeam\n        indexLaunzhContexts={indexLaunzhContexts}\n        editMode={editMode}\n        refreshCounter={refresh}\n        key={id}\n        width={width}\n        height={height}\n        team={team}\n        pinId={parseInt(id)}\n        isPinned\n        onRemovePin={removePin}\n      />\n    );\n  };\n  const addChannel = (team, channel) => {\n    addPin(team, channel);\n  };\n  const addPin = (team, channel) => {\n    var _team = _.cloneDeep(team);\n\n    _team.channel = channel;\n    var id = myTeams.push(_team);\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      id = layouts[key].length.toString();\n      layouts[key].push({\n        team: team.id,\n        x: 0,\n        y: id * 2,\n        w: 2,\n        h: 2,\n\n        i: id,\n      });\n    });\n\n    setLayouts(layouts);\n    setEditMode(true);\n    setRefreshCounter(refreshCounter + 1);\n    setIsModalOpen(false);\n    setMyTeams(myTeams);\n  };\n  const showSearch = () => {\n    setShowCatalogue(!showCatalogue);\n    setRefreshCounter(refreshCounter + 1);\n  };\n  useEffect(() => {\n    async function load() {\n      if (selectedBoard) {\n        window.document.title = \"LAUNZH - \" + selectedBoard;\n      }\n      // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n\n      if (showTabFeature) initGraph(false);\n\n      var search = getSearchParametersFromHRef(window.location.href);\n      if (search.ztickyref) {\n        setZtickyRef(search.ztickyref);\n      }\n      var href = search.src ? search.src : config.defaultTableAPI;\n      setIndexLaunzhContexts(await readIndexOfLaunzhBoards().catch(() => {})); // might not be one\n      readBoardFiles()\n        .then((files) => {\n          var ctxs = [];\n          files.forEach((file) => {\n            if (_.endsWith(file.name.toLowerCase(), \".json\")) {\n              var key = file.name.split(\".\")[0];\n              ctxs.push({ key: key, text: key });\n            }\n          });\n          setContexts(ctxs);\n        })\n        .catch((error) => {\n          //errors.push({ context: \"readContexts\", error });\n          //setErrors(errors);\n          //setIsMounted(true);\n        });\n      if (!isLoaded) {\n        setIsLoaded(true);\n        var l = await readLayouts(BOARDSPATH, boardFileName()).catch((e) => {});\n        if (l) {\n          setMyTeams(l.myTeams);\n          setLayouts(l.layouts);\n          setRefreshCounter(refreshCounter + 1);\n        }\n        setIsMounted(true);\n      }\n\n      setTableUrl(config.defaultTableAPI);\n      readGrid(href, config.defaultTableKey);\n\n      if (!myDrive) {\n        var drive = await getOneDriveFolder(BOARDSPATH).catch(() => {});\n        if (drive) {\n          setMyDrive(drive.webUrl);\n        }\n      }\n    }\n\n    load();\n  }, [refreshCounter, selectedBoard]);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members,\n              };\n              if (cell.members) {\n                cell.members.forEach((id) => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map((name) => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]));\n\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.sortKey = _.toLower(cell.tile.title);\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n      }\n      var queueCount = 0;\n\n      // await OfficeGraph.initStorage();\n\n      myTeams().then(teams =>{\n        setJoinedTeams(teams)\n      })\n\n      var localCache = localStorage.getItem(\"memberships\");\n      var cachedMemberships;\n      try {\n        if (localCache && !refresh) {\n          cachedMemberships = JSON.parse(localCache);\n          setMemberships(cachedMemberships);\n\n          return;\n        }\n      } catch (error) {}\n\n      setRefresing(true);\n      cachedMemberships = await readCache().catch((error) => {\n        errors.push({ context: \"readCache\", error });\n        setErrors(errors);\n      });\n\n      if (cachedMemberships && !refresh) {\n        setMemberships(cachedMemberships);\n        localStorage.setItem(\"memberships\", JSON.stringify(cachedMemberships));\n        setRefresing(false);\n      } else {\n        queueCount++;\n        setProgress(\"Loading\");\n        teamMemberships((percent) => {\n          setProgressPercent(percent);\n        })\n          .then(async (memberships) => {\n            await saveCache(memberships).catch((error) => {\n              errors.push({ context: \"saveCache\", error });\n              setErrors(errors);\n            });\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n            queueCount--;\n            if (queueCount === 0) setRefresing(false);\n            trace(EVENT.MEMBERSHIPSREAD, {\n              \"count-memberships\": memberships.length,\n            });\n            setMemberships(memberships);\n\n            setProgress(\"\");\n          })\n          .catch((error) => {\n            \n            queueCount--;\n            if (queueCount <= 0) setRefresing(false);\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n            setErrors(errors);\n            setProgress(\"\");\n          });\n      }\n      return;\n      // OfficeGraph.initTileStorage()\n      //   .then(async (ztickyFolder) => {\n      //     setZtickyFolder(ztickyFolder);\n      //     queueCount++;\n\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\n      //       ztickyFolder\n      //     );\n      //     //debugger\n      //     var myTools = [];\n      //     if (version < 0) {\n      //       var tileFolders = await OfficeGraph.getMyTools(\n      //         ztickyFolder,\n      //         refresh\n      //       );\n      //       myTools = tileFolders.map((folder) => {\n      //         return {\n      //           title: folder.tile ? folder.tile.title : folder.name,\n      //           tile: folder.tile,\n      //         };\n      //       });\n      //     } else {\n      //       myTools = properties.tiles.map((tile) => {\n      //         if (!tile) return null;\n\n      //         return { title: tile.title, tile };\n      //       });\n      //     }\n\n      //     queueCount--;\n      //     if (queueCount === 0) setRefresing(false);\n      //     setMyTools(myTools);\n      //     setLayouts(layouts);\n      //   })\n      //   .catch((error) => {\n      //     queueCount--;\n      //     if (queueCount <= 0) setRefresing(false);\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\n      //     setErrors(errors);\n      //   });\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    if (!filter) return true;\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var include = true;\n    if (tags.length > 0) {\n      include = false;\n      tags.forEach((tag) => {\n        switch (tag.id) {\n          case \"sharepoint\":\n            if (team.hasSharePoint) {\n              include = true;\n            }\n            break;\n          case \"teams\":\n            if (team.hasTeams) {\n              include = true;\n            }\n\n            break;\n          case \"yammer\":\n            if (team.hasYammer) {\n              include = true;\n            }\n            break;\n          case \"private\":\n            if (team.visibility === \"Private\") {\n              include = true;\n            }\n            break;\n          case \"public\":\n            if (team.visibility === \"Public\") {\n              include = true;\n            }\n            break;\n          default:\n            break;\n        }\n      });\n    }\n    if (!include) return false;\n    if (!filter) return true;\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach((channel) => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n  function persistLayouts(newLayouts) {\n    if (!isMounted) {\n      console.log(\"not mounted, persistLayouts dropped\");\n      return;\n    }\n    setLayouts(newLayouts);\n    setIsDirty(true);\n  }\n  async function saveLayout() {\n    if (!isMounted) {\n      console.log(\"not mounted, persistLayouts dropped\");\n      return;\n    }\n\n    console.log(\"persistLayouts\");\n\n    await writeLayouts(BOARDSPATH, boardFileName(), {\n      layouts,\n      myTeams,\n    }).catch((error) => {\n      errors.push({ context: \"  writeLayouts\", error });\n      setErrors(errors);\n    });\n\n    setIsDirty(false);\n  }\n\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter || tags.length > 0) {\n    tiles.forEach((tile) => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach((folder) => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach((team) => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n\n    // if (\n    //   searchInfo &&\n    //   searchInfo[\"search-for\"] &&\n    //   searchInfo[\"search-for\"] === filter\n    // )\n    //   return;\n\n    // searchInfo = {\n    //   \"search-for\": filter,\n    //   \"found-memberships\": filteredMemberShips.length,\n    //   \"found-tiles\": filteredMyTools.length,\n    // };\n\n    if (logSearchTimer) {\n      console.log(\"Postponing search trace\");\n      clearTimeout(logSearchTimer);\n    }\n    console.log(\"Timeing search trace\");\n    logSearchTimer = setTimeout(() => {\n      console.log(\"sending search trace\");\n      trace(EVENT.SEARCHING, searchInfo);\n      logSearchTimer = null;\n    }, 1000);\n  }\n\n  const dropdownStyles = {\n    dropdown: { flexGrow: 1, border: \"1px\" },\n  };\n\n  if (!(props && props.auth)) {\n    return null;\n    // (\n    //   <div>\n    //     <h1>Sorry - You cannot get in here</h1>\n    //     {JSON.stringify(\n    //       props && props.auth && props.auth.error ? props.auth.error : \"\"\n    //     )}\n    //   </div>\n    // );\n  }\n  var editorCanvasWidth = editMode ? breakpoints[selectedBreakPoint] : null;\n  const buttonProps = {\n    text: \"Try it\",\n  };\n\n  const buttonProps2 = {\n    text: \"Try it again\",\n  };\n\n  return (\n    <div>\n      {!inFrame && config.components.header}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div>\n        {\" \"}\n        {errors.length !== 0 && (\n          <div>\n            <ViewErrors errors={errors} />\n          </div>\n        )}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\",\n              zIndex: 2,\n            }}\n          >\n            <ProgressIndicator\n              percentComplete={progressPercent}\n              xlabel=\"Example title\"\n              xdescription={progress}\n            />\n          </div>\n        )}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\",\n          }}\n          src={titlegraphics}\n        ></img>\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"xnone\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\",\n              }}\n            >\n              {showTabFeature && (\n                <div>\n                  <i\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\n                    className=\"ms-Icon ms-Icon--Refresh\"\n                    onClick={() => {\n                      initGraph(true);\n                    }}\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  {refreshing && <>Loading</>}\n                </div>\n              )}\n            </div>\n            {!inFrame && (\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  top: 0,\n                  zIndex: 32,\n                  marginRight: \"16px\",\n                  width: \"calc(100vw - 200px)\",\n                }}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div\n                    style={{\n                      marginLeft: \"16px\",\n                      marginTop: \"10px\",\n                      flexGrow: 1,\n                    }}\n                  >\n                    {\" \"}\n                    {!editMode && (\n                      <div style={{ display: \"flex\" }}>\n                        <div\n                          style={{\n                            flexGrow: 1,\n                          }}\n                        >\n                          <Dropdown\n                            disabled={showTable}\n                            placeholder=\"Select board\"\n                            selectedKey={selectedBoard}\n                            xlabel=\"View as\"\n                            onChanged={(option, index) => {\n                              gotoBoard(option.key);\n\n                              //debugger\n                            }}\n                            options={contexts.map((ctx) => {\n                              return { key: ctx.key, text: ctx.text };\n                            })}\n                            styles={dropdownStyles}\n                          />\n                        </div>\n                        <div\n                          style={{\n                            marginLeft: \"16px\",\n                            xmarginTop: \"4px\",\n                          }}\n                        >\n                          <IconButton\n                            styles={{ fontSize: \"24px\" }}\n                            iconProps={{ iconName: \"Add\" }}\n                            ariaLabel=\"Add\"\n                            onClick={() => setAddingBoard(true)}\n                          />\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                  {addingBoard && (\n                    <AddBoard\n                      onDismiss={() => {\n                        setAddingBoard(false);\n                      }}\n                      onAdd={(name) => {\n                        gotoBoard(name);\n                        setAddingBoard(false);\n                      }}\n                    />\n                  )}\n                  {editMode && (\n                    <>\n                      <div style={{ marginTop: \"16px\", marginRight: \"8px\" }}>\n                        Screen width&nbsp;\n                      </div>\n                      <div>\n                        <BreakPointSelector\n                          selected={selectedBreakPoint}\n                          breakpoints={breakpoints}\n                          onSelect={(breakPoint) => {\n                            setSelectedBreakPoint(breakPoint);\n                          }}\n                        />\n                      </div>\n\n                      <div style={{ marginTop: \"8px\" }}>\n                        <IconButton\n                          styles={{ fontSize: \"24px\" }}\n                          disabled={!isDirty}\n                          iconProps={{ iconName: \"Save\" }}\n                          ariaLabel=\"Save\"\n                          onClick={() => saveLayout()}\n                        />\n                      </div>\n                    </>\n                  )}\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>Edit</div>\n\n                  <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={editMode}\n                      onChange={(e, checked) => {\n                        setEditMode(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div>\n                  <div style={{ marginTop: \"4px\" }}>\n                    <CommandBar\n                      farItems={[\n                        // {\n                        //   key: \"tile\",\n                        //   text: \"Grid view\",\n                        //   // This needs an ariaLabel since it's icon-only\n                        //   ariaLabel: \"Grid view\",\n                        //   iconOnly: true,\n                        //   iconProps: { iconName: \"Tiles\" },\n                        //   onClick: () => console.log(\"Tiles\"),\n                        // },\n                        {\n                          key: \"info\",\n                          text: \"Info\",\n                          // This needs an ariaLabel since it's icon-only\n                          ariaLabel: \"Info\",\n                          iconOnly: true,\n                          iconProps: { iconName: \"CollapseMenu\" },\n                          onClick: () => console.log(\"Info\"),\n                          subMenuProps: {\n                            items: [\n                              {\n                                key: \"allBoards\",\n                                text: \"Boards\",\n                                iconProps: { iconName: \"AllApps\" },\n                                onClick: () => {\n                                  navigate(\"/boards\");\n                                }, // optional\n                              },\n                              {\n                                key: \"check\",\n                                text: \"Check\",\n                                iconProps: { iconName: \"ReceiptCheck\" },\n                                onClick: () => {\n                                  navigate(\"/check\");\n                                }, // optional\n                              },\n                              {\n                                key: \"onedrive\",\n                                text: \"OneDrive files\",\n                                disabled: !myDrive,\n                                iconProps: { iconName: \"OneDriveLogo\" },\n                                onClick: () => {\n                                  window.open(myDrive);\n                                }, // optional\n                              },\n\n                              {\n                                key: \"signout\",\n                                text: \"Sign Out\",\n                                iconProps: { iconName: \"SignOut\" },\n                                onClick: () => {\n                                  if (props.signOut) {\n                                    props.signOut();\n                                  }\n                                }, // optional\n                              },\n                              {\n                                key: \"debug\",\n                                text: \"Debug\",\n                                iconProps: { iconName: \"SearchAndApps\" },\n                                onClick: () => {\n                                  navigate(\"/debug\");\n                                }, // optional\n                              },\n                            ],\n                          },\n                        },\n                      ]}\n                      ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n                    />\n                  </div>\n\n                  {/* <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={showCatalogue}\n                      onChange={(e, checked) => {\n                        setShowCatalogue(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div> */}\n                </div>\n              </div>\n            )}\n            <div style={{ flexGrow: \"1\" }}>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  marginTop: \"8px\",\n                }}\n              >\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\n                  {/* <TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  /> */}\n\n                  {/* */}\n                </div>{\" \"}\n              </div>\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  bottom: 0,\n                  zIndex: 32,\n                }}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                    <i\n                      ref={searchIconRef}\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      className=\"ms-Icon ms-Icon--Add tilesearch\"\n                      onClick={() => {\n                        showSearch();\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                </div>\n              </div>\n              <div style={isFixedWidth ? { backgroundColor: \"#666666\" } : {}}>\n                <div\n                  style={\n                    editMode\n                      ? {\n                          marginRight: \"auto\",\n                          marginLeft: \"auto\",\n                          width: editorCanvasWidth,\n                          minHeight: \"100vh\",\n                          backgroundColor: \"#ffffff\",\n                        }\n                      : isFixedWidth\n                      ? {\n                          marginRight: \"auto\",\n                          marginLeft: \"auto\",\n                          maxWidth: 1200,\n                          minHeight: \"100vh\",\n                          backgroundColor: \"#ffffff\",\n                        }\n                      : {}\n                  }\n                >\n                  {!isMounted && (\n                    <div style={{ height: \"90vh\", marginTop: \"40vh\" }}>\n                      <Spinner label=\"Assembling your board ...\" />\n                    </div>\n                  )}\n                  {isMounted && myTeams.length === 0 && showWarning && (\n                    <MessageBar\n                      messageBarType={MessageBarType.warning}\n                      isMultiline={false}\n                      onDismiss={() => {\n                        setShowWarning(false);\n                      }}\n                      dismissButtonAriaLabel=\"Close\"\n                      xactions={\n                        <div>\n                          <MessageBarButton\n                            onClick={() => {\n                              setEditMode(true);\n                              setShowWarning(false);\n                              showSearch();\n                            }}\n                          >\n                            {\" \"}\n                            Add Tiles\n                          </MessageBarButton>\n                        </div>\n                      }\n                    >\n                      Hi, you are not member of any Teams\n                    </MessageBar>\n                  )}\n\n                  <Coachmark\n                    target={searchIconRef}\n                    positioningContainerProps={{\n                      directionalHint: DirectionalHint.topAutoEdge,\n                      doNotLayer: false,\n                    }}\n                    ariaAlertText=\"A Coachmark has appeared\"\n                    ariaDescribedBy={\"coachmark-desc1\"}\n                    ariaLabelledBy={\"coachmark-label1\"}\n                    ariaDescribedByText={\n                      \"Press enter or alt + C to open the Coachmark notification\"\n                    }\n                    ariaLabelledByText={\"Coachmark notification\"}\n                  >\n                    Welcome to the land of Coachmarks!\n                  </Coachmark>\n                  <ToolboxLayout\n                    indexLaunzhContexts={indexLaunzhContexts}\n                    tools={myTools}\n                    layouts={layouts}\n                    persist={persistLayouts}\n                    editMode={editMode}\n                    getPin={getPin}\n                    onRemovePin={removePin}\n                    fixedWidth={editorCanvasWidth}\n                    onTileClick={(tile) => {\n                      setCurrentTile(tile);\n                      setIsZoomed(true);\n                    }}\n                  />\n                </div>\n              </div>\n\n              {/* {siteUrl && (\n                 \n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n              {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n              {showTable && (\n                <>\n                  <div style={{ textAlign: \"right\" }}>\n                    <i\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                      onClick={() => {\n                        window.open(tableUrl, \"_blank\");\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                  <iframe\n                    style={{\n                      border: \"0\",\n                      height: \"calc(100vh - 150px\",\n                      width: \"95vw\",\n                    }}\n                    src={tableUrl}\n                  ></iframe>\n                </>\n              )}\n              {/* {showCatalogue && showTabFeature && memberships.length > 0 && ( */}\n              <Modal\n                titleAriaId={1}\n                isOpen={isModalOpen}\n                onDismiss={() => setIsModalOpen(false)}\n                isBlocking={false}\n                containerClassName={contentStyles.container}\n                xdragOptions={dragOptions}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div style={{ flexGrow: 1 }}></div>\n                  <div>\n                    <IconButton\n                      styles={iconButtonStyles}\n                      iconProps={cancelIcon}\n                      ariaLabel=\"Close popup modal\"\n                      onClick={() => setIsModalOpen(false)}\n                    />\n                  </div>\n                </div>\n                <div className={contentStyles.body}>\n                  <TextField\n                    autoFocus={false}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                  <div style={{ display: \"flex\" }}>\n                    <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                      Show details\n                    </div>\n                    <div style={{ marginTop: \"16px\" }}>\n                      <Toggle\n                        checked={showDetails}\n                        onChange={(e, checked) => {\n                          setShowDetails(checked);\n                          setRefreshCounter(refreshCounter + 1);\n                        }}\n                      />\n                    </div>\n                    <div>\n                      {/* <ReactTags\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\n                    autofocus={false}\n                    tags={tags}\n                    suggestions={[\n                      {\n                        name: \"Teams\",\n                        id: \"teams\",\n                      },\n                      {\n                        name: \"SharePoint\",\n                        id: \"sharepoint\",\n                      },\n                      {\n                        name: \"Yammer\",\n                        id: \"yammer\",\n                      },\n                      {\n                        name: \"Private\",\n                        id: \"private\",\n                      },\n                      {\n                        name: \"Public\",\n                        id: \"public\",\n                      },\n                    ]}\n                    handleDelete={(i) => {\n                      const tgs = tags.slice(0);\n                      tgs.splice(i, 1);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                    handleAddition={(tag) => {\n                      var tgs = [].concat(tags, tag);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                  />  */}\n                    </div>\n                  </div>\n\n                  <ViewTeams\n                    onSaveTeam={addPin}\n                    onSaveChannel={addChannel}\n                    refreshCounter={refreshCounter}\n                    tiles={filteredTiles}\n                    details={showDetails}\n                    memberShips={filteredMemberShips}\n                    filter={filter}\n                    highlightStyle={{ backgroundColor: \"yellow\" }}\n                  />\n                </div>\n              </Modal>\n              {/* )} */}\n              {!showTable && !showTabFeature && (\n                <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                  {filteredTiles.length === 0 && (\n                    <div>\n                      <h2>Sorry. No matches for \"{filter}\"</h2>\n                      {/* <h1>\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">\n                          Request a link\n                        </a>\n                      </h1> */}\n                    </div>\n                  )}\n                  {filteredTiles.map((tile, key) => {\n                    if (selectedGroup) {\n                      var match = false;\n\n                      if (!tile.references) return null;\n                      tile.references.forEach((r) => {\n                        if (r.title === selectedGroup) {\n                          match = true;\n                        }\n                      });\n                      if (!match) return null;\n                    }\n                    return (\n                      <AppSuperTile\n                        tileSize={tileSize}\n                        key={key}\n                        filter={filter}\n                        highlightStyle={{\n                          backgroundColor: \"yellow\",\n                          color: \"#333\",\n                        }}\n                        tile={tile}\n                        onPinnedClicked={(props) => {\n                          if (props.tile) {\n                            addPin(props.tile);\n                          }\n                        }}\n                        onClick={(tile) => {\n                          if (window.amplitude) {\n                            if (\n                              props &&\n                              props.auth &&\n                              props.auth.user &&\n                              props.auth.user.userPrincipalName\n                            )\n                              window.amplitude\n                                .getInstance()\n                                .identify(props.auth.user.userPrincipalName);\n                            window.amplitude\n                              .getInstance()\n                              .logEvent(\"tool\", tile);\n                          }\n                          if (tile.jumpto && !tile.messageBeforeLaunch) {\n                            return window.open(tile.jumpto, \"_blank\");\n                          }\n                          setCurrentTile(tile);\n                          setIsZoomed(true);\n                        }}\n                      />\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* \n\n              */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\",\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {false && props && props.auth && props.auth.user && (\n        <div style={{ textAlign: \"center\" }}>\n          You are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\n          &nbsp;\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\n            https://portal.office.com/account/#apps\n          </a>\n        </div>\n      )}\n    </div>\n  );\n\n  function boardFileName() {\n    var name = props.board ? props.board : \"default\";\n    return `${name}.json`;\n  }\n}\nfunction newFunction() {\n  return (\n    <div>\n      <div></div>\n      <div></div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  CommandBar,\n  getTheme,\n  Coachmark,\n  DirectionalHint,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n  Spinner,\n  Label,\n} from \"office-ui-fabric-react\";\n\nexport const MyTeam = props => {\n \n  return (\n\n    <div class=\"Karlo\">\n    {(props.joinedTeams ? props.joinedTeams : []).map((team) => {\n      return (\n        <div class=\"KarlosTeam\">\n\n          <div class=\"KarloCard\">\n            <div class=\"Header\"> {team.displayName}</div>\n            <div class=\"Actions\"><DefaultButton onClick={()=>{if (props.onMeetNow){\n              props.onMeetNow(team)\n            }}}>Meet now</DefaultButton></div>\n          </div>\n         \n          \n        </div>\n      );\n    })}\n  </div>\n  )\n};\n// Tags.propTypes = {\n//   references: PropTypes.array\n// };\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\n\nimport { TextField, Dropdown, DropdownBase } from \"@fluentui/react\";\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\n\nimport { initializeIcons } from \"@uifabric/icons\";\nimport axios from \"axios\";\nimport _, { forEach, join } from \"lodash\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport \"./App.css\";\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport ToolboxLayout, { breakpoints } from \"./components/ToolboxLayout\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeam, ViewTeams } from \"./components/ViewTeams\";\nimport config from \"./config\";\nimport \"./css/normalize.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport \"./css/webflow.css\";\nimport { getSearchParametersFromHRef, inIframe, teamsMeetingUrlFromBody } from \"./helpers\";\nimport {\n  BOARDSPATH,\n  readCache,\n  readLayouts,\n  saveCache,\n  writeLayouts,\n  readBoardFiles,\n  readIndexOfLaunzhBoards,\n} from \"./helpers/LaunchPad\";\nimport {\n  teamMemberships,\n  getOneDriveFolder,\n  MyTeams,\n  readTeamInfoAsGuest,\n} from \"./helpers/OfficeGraph\";\nimport { EVENT, trace } from \"./helpers/trace\";\n\nimport {\n  CommandBar,\n  getTheme,\n  Coachmark,\n  DirectionalHint,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n  Spinner,\n  Label,\n} from \"office-ui-fabric-react\";\n\nimport { navigate } from \"@reach/router\";\nimport BreakPointSelector from \"./components/BreakPointSelector\";\nimport {\n  MessageBarButton,\n  Link,\n  Stack,\n  StackItem,\n  MessageBar,\n  MessageBarType,\n  ChoiceGroup,\n  IStackProps,\n} from \"office-ui-fabric-react\";\nimport AddBoard from \"./components/AddBoard\";\nimport { MyTeam } from \"./components/MyTeam\";\n\nconst dragOptions = {\n  moveMenuItemText: \"Move\",\n  closeMenuItemText: \"Close\",\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: \"Cancel\" };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n    alignItems: \"stretch\",\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: \"1 1 auto\",\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: \"flex\",\n      alignItems: \"center\",\n      fontWeight: FontWeights.semibold,\n      padding: \"12px 12px 14px 24px\",\n    },\n  ],\n  body: {\n    flex: \"4 4 auto\",\n    padding: \"0 24px 24px 24px\",\n    minWidth: \"95vw\",\n    minHeight: \"90vh\",\n    overflowY: \"hidden\",\n    selectors: {\n      p: { margin: \"14px 0\" },\n      \"p:first-child\": { marginTop: 0 },\n      \"p:last-child\": { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: \"auto\",\n    marginTop: \"4px\",\n    marginRight: \"2px\",\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nvar logSearchTimer;\nvar searchInfo;\n\ninitializeIcons();\n\nlet isOfficeInitialized = false;\nasync function getGraphToken(bootstrapToken) {\n\n  return \"\";\n}\n/* Render application after Office initializes */\n\nif (window.Office) {\n  window.Office.initialize = async () => {\n    isOfficeInitialized = true;\n  };\n}\n\nexport default function App(props) {\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n  const inFrame = inIframe();\n  const searchIconRef = useRef();\n  const [showTabFeature, setThowTabFeature] = useState(\n    false //config.teamsIntegration || upnIs(config.niels)\n  );\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, _setFilter] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [speedDate, setSpeedDate] = useState(null);\n  const [tiles, setTiles] = useState([]);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [me, setMe] = useState({});\n  var [myTools, setMyTools] = useState([]);\n  const [joinedTeams, setJoinedTeams] = useState([]);\n  const [myTeams, setMyTeams] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [contexts, setContexts] = useState([]);\n  const [selectedBoard, setSelectedBoard] = useState(props.board);\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [progressPercent, setProgressPercent] = useState(null);\n  const [showTable, setShowTable] = useState(false);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({\n    lg: [\n      // {\n      //   x: 0,\n      //   y: Infinity,\n      //   w: 3,\n      //   h: 3,\n      //   i: \"1\",\n      //   static: 0, //Math.random() < 0.05,\n      // },\n    ],\n  });\n  const [refreshCounter, setRefreshCounter] = useState(0);\n  const [tags, setTags] = useState([]);\n  const [showDetails, _setShowDetails] = useState(true);\n  const [showCatalogue, _setShowCatalogue] = useState(!inIframe());\n  const [editMode, _setEditMode] = useState(false); //!inIframe());\n  const [isFixedWidth, setIsFixedWidth] = useState(true); //!inIframe());\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [groups, setGroups] = useState([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedBreakPoint, setSelectedBreakPoint] = useState(\"lg\");\n  const [isMounted, setIsMounted] = useState(false);\n  const [isDirty, setIsDirty] = useState(false);\n  const [showWarning, setShowWarning] = useState(true);\n  const [indexLaunzhContexts, setIndexLaunzhContexts] = useState([]);\n  const [myDrive, setMyDrive] = useState(\"\");\n  const [addingBoard, setAddingBoard] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [meetingUrl, setMeetingUrl] = useState(null);\n\n  function gotoBoard(boardName) {\n    setSelectedBoard(boardName);\n    window.location.href = `/board/${boardName}`;\n  }\n  function setEditMode(on) {\n    if (on) {\n      setIsDirty(false);\n    }\n    _setEditMode(on);\n  }\n  function setShowDetails(on) {\n    _setShowDetails(on);\n    trace(EVENT.DETAILSTOGGLED, { on });\n  }\n  function setShowCatalogue(on) {\n    _setShowCatalogue(on);\n    setIsModalOpen(true);\n    trace(EVENT.SEARCHCLICKED, { on });\n  }\n\n  function setFilter(value) {\n    setSearch(value);\n    if (_.startsWith(value, \".\")) {\n    } else {\n      _setFilter(value);\n    }\n  }\n\n  const _setTags = (t) => {\n\n    setTags(t);\n  };\n\n  const removePin = (pinId) => {\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      layouts[key].splice(pinId, 1);\n\n      layouts[key] = layouts[key].map((m, ix) => {\n        m.i = ix.toString();\n        return m;\n      });\n    });\n\n    myTeams.splice(pinId, 1);\n\n    setLayouts(layouts);\n\n    setMyTeams(myTeams);\n    setRefreshCounter(refreshCounter + 1);\n  };\n\n  const addChannel = (team, channel) => {\n    addPin(team, channel);\n  };\n  const addPin = (team, channel) => {\n    var _team = _.cloneDeep(team);\n\n    _team.channel = channel;\n    var id = myTeams.push(_team);\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      id = layouts[key].length.toString();\n      layouts[key].push({\n        team: team.id,\n        x: 0,\n        y: id * 2,\n        w: 2,\n        h: 2,\n\n        i: id,\n      });\n    });\n\n    setLayouts(layouts);\n    setEditMode(true);\n    setRefreshCounter(refreshCounter + 1);\n    setIsModalOpen(false);\n    setMyTeams(myTeams);\n  };\n  const showSearch = () => {\n    setShowCatalogue(!showCatalogue);\n    setRefreshCounter(refreshCounter + 1);\n  };\n  const updateTeamWithInfo = (team,info) =>{\n    if (joinedTeams){\n      \n      joinedTeams.forEach(joinedTeam => {\n        if (joinedTeam.id = team.id){\n          joinedTeam.info = info\n          return setJoinedTeams(joinedTeams)\n        }\n      });\n    }\n  }\n  useEffect(() => {\n    async function load() {\n      MyTeams().then((teams) => {\n        \n   \n        setJoinedTeams(teams);\n      });\n      if (selectedBoard) {\n        window.document.title = \"LAUNZH - \" + selectedBoard;\n      }\n      // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n\n      if (showTabFeature) initGraph(false);\n\n      var search = getSearchParametersFromHRef(window.location.href);\n      if (search.ztickyref) {\n        setZtickyRef(search.ztickyref);\n      }\n      var href = search.src ? search.src : config.defaultTableAPI;\n      setIndexLaunzhContexts(await readIndexOfLaunzhBoards().catch(() => {})); // might not be one\n      readBoardFiles()\n        .then((files) => {\n          var ctxs = [];\n          files.forEach((file) => {\n            if (_.endsWith(file.name.toLowerCase(), \".json\")) {\n              var key = file.name.split(\".\")[0];\n              ctxs.push({ key: key, text: key });\n            }\n          });\n          setContexts(ctxs);\n        })\n        .catch((error) => {\n          //errors.push({ context: \"readContexts\", error });\n          //setErrors(errors);\n          //setIsMounted(true);\n        });\n      if (!isLoaded) {\n        setIsLoaded(true);\n        var l = await readLayouts(BOARDSPATH, boardFileName()).catch((e) => {});\n        if (l) {\n          setMyTeams(l.myTeams);\n          setLayouts(l.layouts);\n          setRefreshCounter(refreshCounter + 1);\n        }\n        setIsMounted(true);\n      }\n\n      setTableUrl(config.defaultTableAPI);\n      readGrid(href, config.defaultTableKey);\n\n      if (!myDrive) {\n        var drive = await getOneDriveFolder(BOARDSPATH).catch(() => {});\n        if (drive) {\n          setMyDrive(drive.webUrl);\n        }\n      }\n    }\n\n    load();\n  }, [refreshCounter, selectedBoard]);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members,\n              };\n              if (cell.members) {\n                cell.members.forEach((id) => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map((name) => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]));\n\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.sortKey = _.toLower(cell.tile.title);\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n      }\n      var queueCount = 0;\n\n      // await OfficeGraph.initStorage();\n\n      var localCache = localStorage.getItem(\"memberships\");\n      var cachedMemberships;\n      try {\n        if (localCache && !refresh) {\n          cachedMemberships = JSON.parse(localCache);\n          setMemberships(cachedMemberships);\n\n          return;\n        }\n      } catch (error) {}\n\n      setRefresing(true);\n      cachedMemberships = await readCache().catch((error) => {\n        errors.push({ context: \"readCache\", error });\n        setErrors(errors);\n      });\n\n      if (cachedMemberships && !refresh) {\n        setMemberships(cachedMemberships);\n        localStorage.setItem(\"memberships\", JSON.stringify(cachedMemberships));\n        setRefresing(false);\n      } else {\n        queueCount++;\n        setProgress(\"Loading\");\n        teamMemberships((percent) => {\n          setProgressPercent(percent);\n        })\n          .then(async (memberships) => {\n            await saveCache(memberships).catch((error) => {\n              errors.push({ context: \"saveCache\", error });\n              setErrors(errors);\n            });\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n            queueCount--;\n            if (queueCount === 0) setRefresing(false);\n            trace(EVENT.MEMBERSHIPSREAD, {\n              \"count-memberships\": memberships.length,\n            });\n            setMemberships(memberships);\n\n            setProgress(\"\");\n          })\n          .catch((error) => {\n            \n            queueCount--;\n            if (queueCount <= 0) setRefresing(false);\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n            setErrors(errors);\n            setProgress(\"\");\n          });\n      }\n      return;\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    if (!filter) return true;\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var include = true;\n    if (tags.length > 0) {\n      include = false;\n      tags.forEach((tag) => {\n        switch (tag.id) {\n          case \"sharepoint\":\n            if (team.hasSharePoint) {\n              include = true;\n            }\n            break;\n          case \"teams\":\n            if (team.hasTeams) {\n              include = true;\n            }\n\n            break;\n          case \"yammer\":\n            if (team.hasYammer) {\n              include = true;\n            }\n            break;\n          case \"private\":\n            if (team.visibility === \"Private\") {\n              include = true;\n            }\n            break;\n          case \"public\":\n            if (team.visibility === \"Public\") {\n              include = true;\n            }\n            break;\n          default:\n            break;\n        }\n      });\n    }\n    if (!include) return false;\n    if (!filter) return true;\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach((channel) => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter || tags.length > 0) {\n    tiles.forEach((tile) => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach((folder) => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach((team) => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n\n    if (logSearchTimer) {\n      console.log(\"Postponing search trace\");\n      clearTimeout(logSearchTimer);\n    }\n    console.log(\"Timeing search trace\");\n    logSearchTimer = setTimeout(() => {\n      console.log(\"sending search trace\");\n      trace(EVENT.SEARCHING, searchInfo);\n      logSearchTimer = null;\n    }, 1000);\n  }\n\n  const dropdownStyles = {\n    dropdown: { flexGrow: 1, border: \"1px\" },\n  };\n\n  if (!(props && props.auth)) {\n    return null;\n    // (\n    //   <div>\n    //     <h1>Sorry - You cannot get in here</h1>\n    //     {JSON.stringify(\n    //       props && props.auth && props.auth.error ? props.auth.error : \"\"\n    //     )}\n    //   </div>\n    // );\n  }\n  var editorCanvasWidth = editMode ? breakpoints[selectedBreakPoint] : null;\n  const buttonProps = {\n    text: \"Try it\",\n  };\n\n  const buttonProps2 = {\n    text: \"Try it again\",\n  };\n  const meetNow = (team) => {\n    setProcessing(true);\n    var sponsor = props.auth && props.auth.user ? props.auth.user.mail : \"\";\n\n    var data = JSON.stringify({\n      url:\n        \"https://365adm.sharepoint.com/sites/cop/SitePages/Sensitivity-Labels.aspx\",\n      linkText: \"Sensitivity Labels\",\n      subject: \"Looking for a match to talk about Sensitivity Labels\",\n      from: \"2020-11-11T14:45:00\",\n      to: \"2020-11-11T14:55:00\",\n      teamName: team.displayName,\n      teamId: team.id,\n      sponsor,\n      facilitator1: \"niels@jumpto365.com\",\n      facilitator2: \"niels@jumpto365.com\",\n      optionalAttendeesEmails: [\"dsf\", \"asf\"],\n      attendeesEmails: [\"dsf\", \"asf\"],\n    });\n\n    var config = {\n      method: \"post\",\n      url:\n        \"https://prod-26.northeurope.logic.azure.com:443/workflows/cf350587a4ba4621b3d63e8538076a5c/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=66v57Zr6-OZt6n24i0AabA3hrWD0k-kM_Qqle7C4_Ro\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        \n        setSpeedDate(response.data);\n        \n        setMeetingUrl(teamsMeetingUrlFromBody(response.data.event.body.content))\n      \n        setProcessing(false);\n        console.log(JSON.stringify());\n      })\n      .catch(function (error) {\n        errors.push({ context: \"meetNow\", error });\n        setProcessing(false);\n        setErrors(errors);\n        console.log(error);\n      });\n  };\n  return (\n    <div>\n      {!inFrame && config.components.header}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div>\n        {\" \"}\n        {errors.length !== 0 && (\n          <div>\n            <ViewErrors errors={errors} />\n          </div>\n        )}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\",\n              zIndex: 2,\n            }}\n          >\n            <ProgressIndicator\n              percentComplete={progressPercent}\n              xlabel=\"Example title\"\n              xdescription={progress}\n            />\n          </div>\n        )}\n        {processing && <ProgressIndicator label=\"Creating invitation\" />}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\",\n          }}\n          src={titlegraphics}\n        ></img>\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"xnone\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\",\n              }}\n            ></div>\n            {!inFrame && (\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  top: 0,\n                  zIndex: 32,\n                  marginRight: \"16px\",\n                  width: \"calc(100vw - 200px)\",\n                }}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div\n                    style={{\n                      marginLeft: \"16px\",\n                      marginTop: \"10px\",\n                      flexGrow: 1,\n                    }}\n                  >\n                    {\" \"}\n                    {!editMode && (\n                      <div style={{ display: \"flex\" }}>\n                        <div\n                          style={{\n                            flexGrow: 1,\n                          }}\n                        >\n                          <Dropdown\n                            hidden\n                            disabled={showTable}\n                            placeholder=\"Select board\"\n                            selectedKey={selectedBoard}\n                            xlabel=\"View as\"\n                            onChanged={(option, index) => {\n                              gotoBoard(option.key);\n\n                              //debugger\n                            }}\n                            options={contexts.map((ctx) => {\n                              return { key: ctx.key, text: ctx.text };\n                            })}\n                            styles={dropdownStyles}\n                          />\n                        </div>\n                        <div\n                          style={{\n                            marginLeft: \"16px\",\n                            xmarginTop: \"4px\",\n                          }}\n                        >\n                          <IconButton\n                            hidden\n                            styles={{ fontSize: \"24px\" }}\n                            iconProps={{ iconName: \"Add\" }}\n                            ariaLabel=\"Add\"\n                            onClick={() => setAddingBoard(true)}\n                          />\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                  {addingBoard && (\n                    <AddBoard\n                      onDismiss={() => {\n                        setAddingBoard(false);\n                      }}\n                      onAdd={(name) => {\n                        gotoBoard(name);\n                        setAddingBoard(false);\n                      }}\n                    />\n                  )}\n                  {editMode && (\n                    <>\n                      <div style={{ marginTop: \"16px\", marginRight: \"8px\" }}>\n                        Screen width&nbsp;\n                      </div>\n                      <div>\n                        <BreakPointSelector\n                          selected={selectedBreakPoint}\n                          breakpoints={breakpoints}\n                          onSelect={(breakPoint) => {\n                            setSelectedBreakPoint(breakPoint);\n                          }}\n                        />\n                      </div>\n\n                      <div style={{ marginTop: \"8px\" }}>\n                        <IconButton\n                          styles={{ fontSize: \"24px\" }}\n                          disabled={!isDirty}\n                          iconProps={{ iconName: \"Save\" }}\n                          ariaLabel=\"Save\"\n                          onClick={() => {}}\n                        />\n                      </div>\n                    </>\n                  )}\n                  {false && (\n                    <>\n                      <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                        Edit\n                      </div>\n\n                      <div style={{ marginTop: \"16px\" }}>\n                        <Toggle\n                          checked={editMode}\n                          onChange={(e, checked) => {\n                            setEditMode(checked);\n                            setRefreshCounter(refreshCounter + 1);\n                          }}\n                        />\n                      </div>\n                    </>\n                  )}\n                  <div style={{ marginTop: \"4px\" }}>\n                    <CommandBar\n                      farItems={[\n                        // {\n                        //   key: \"tile\",\n                        //   text: \"Grid view\",\n                        //   // This needs an ariaLabel since it's icon-only\n                        //   ariaLabel: \"Grid view\",\n                        //   iconOnly: true,\n                        //   iconProps: { iconName: \"Tiles\" },\n                        //   onClick: () => console.log(\"Tiles\"),\n                        // },\n                        {\n                          key: \"info\",\n                          text: \"Info\",\n                          // This needs an ariaLabel since it's icon-only\n                          ariaLabel: \"Info\",\n                          iconOnly: true,\n                          iconProps: { iconName: \"CollapseMenu\" },\n                          onClick: () => console.log(\"Info\"),\n                          subMenuProps: {\n                            items: [\n                              // {\n                              //   key: \"allBoards\",\n                              //   text: \"Boards\",\n                              //   iconProps: { iconName: \"AllApps\" },\n                              //   onClick: () => {\n                              //     navigate(\"/boards\");\n                              //   }, // optional\n                              // },\n                              {\n                                key: \"check\",\n                                text: \"Check\",\n                                iconProps: { iconName: \"ReceiptCheck\" },\n                                onClick: () => {\n                                  navigate(\"/check\");\n                                }, // optional\n                              },\n                              // {\n                              //   key: \"onedrive\",\n                              //   text: \"OneDrive files\",\n                              //   disabled: !myDrive,\n                              //   iconProps: { iconName: \"OneDriveLogo\" },\n                              //   onClick: () => {\n                              //     window.open(myDrive);\n                              //   }, // optional\n                              // },\n\n                              {\n                                key: \"signout\",\n                                text: \"Sign Out\",\n                                iconProps: { iconName: \"SignOut\" },\n                                onClick: () => {\n                                  if (props.signOut) {\n                                    props.signOut();\n                                  }\n                                }, // optional\n                              },\n                              {\n                                key: \"debug\",\n                                text: \"Debug\",\n                                iconProps: { iconName: \"SearchAndApps\" },\n                                onClick: () => {\n                                  navigate(\"/debug\");\n                                }, // optional\n                              },\n                            ],\n                          },\n                        },\n                      ]}\n                      ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n                    />\n                  </div>\n\n                  {/* <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={showCatalogue}\n                      onChange={(e, checked) => {\n                        setShowCatalogue(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div> */}\n                </div>\n              </div>\n            )}\n            <div style={{ flexGrow: \"1\" }}>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  marginTop: \"8px\",\n                }}\n              >\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\n                  {/* <TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  /> */}\n\n                  {/* */}\n                </div>{\" \"}\n              </div>\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  bottom: 0,\n                  zIndex: 32,\n                }}\n              >\n                {false && (\n                  <div style={{ display: \"flex\" }}>\n                    <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                      <i\n                        ref={searchIconRef}\n                        style={{ cursor: \"pointer\", padding: \"4px\" }}\n                        className=\"ms-Icon ms-Icon--Add tilesearch\"\n                        onClick={() => {\n                          showSearch();\n                        }}\n                        aria-hidden=\"true\"\n                      ></i>\n                    </div>\n                  </div>\n                )}\n              </div>\n              <div style={isFixedWidth ? { backgroundColor: \"#666666\" } : {}}>\n                <div\n                  style={\n                    editMode\n                      ? {\n                          marginRight: \"auto\",\n                          marginLeft: \"auto\",\n                          width: editorCanvasWidth,\n                          minHeight: \"100vh\",\n                          backgroundColor: \"#ffffff\",\n                        }\n                      : isFixedWidth\n                      ? {\n                          marginRight: \"auto\",\n                          marginLeft: \"auto\",\n                          maxWidth: 1200,\n                          minHeight: \"100vh\",\n                          backgroundColor: \"#ffffff\",\n                        }\n                      : {}\n                  }\n                >\n                  {!isMounted && (\n                    <div style={{ height: \"90vh\", marginTop: \"40vh\" }}>\n                      <Spinner label=\"Assembling your board ...\" />\n                    </div>\n                  )}\n                  {speedDate && (\n                    <MessageBar\n                      messageBarType={MessageBarType.info}\n                      isMultiline={false}\n                      onDismiss={() => {\n                        setSpeedDate(null);\n                      }}\n                      dismissButtonAriaLabel=\"Close\"\n                      actions={\n                        <div>\n                          {meetingUrl &&\n                          <MessageBarButton\n                            onClick={() => {\n                              window.open(meetingUrl, \"_blank\");\n                            }}\n                          >\n                            {\" \"}\n                            Join Meeting now\n                          </MessageBarButton>}\n                        </div>\n                      }\n                    >\n                      Speeddate invitation send\n                    </MessageBar>\n                  )}\n                  {isMounted && joinedTeams.length === 0 && showWarning && (\n                    <MessageBar\n                      messageBarType={MessageBarType.warning}\n                      isMultiline={false}\n                      onDismiss={() => {\n                        setShowWarning(false);\n                      }}\n                      dismissButtonAriaLabel=\"Close\"\n                      actions={\n                        <div>\n                          <MessageBarButton\n                            onClick={() => {\n                              setEditMode(true);\n                              setShowWarning(false);\n                              showSearch();\n                            }}\n                          >\n                            {\" \"}\n                            Add Tiles\n                          </MessageBarButton>\n                        </div>\n                      }\n                    >\n                      Hi, nothing on this board\n                    </MessageBar>\n                  )}\n\n                  <MyTeam\n                    joinedTeams={joinedTeams}\n                    processing={processing}\n                    onMeetNow={meetNow}\n                  />\n\n                  <Coachmark\n                    target={searchIconRef}\n                    positioningContainerProps={{\n                      directionalHint: DirectionalHint.topAutoEdge,\n                      doNotLayer: false,\n                    }}\n                    ariaAlertText=\"A Coachmark has appeared\"\n                    ariaDescribedBy={\"coachmark-desc1\"}\n                    ariaLabelledBy={\"coachmark-label1\"}\n                    ariaDescribedByText={\n                      \"Press enter or alt + C to open the Coachmark notification\"\n                    }\n                    ariaLabelledByText={\"Coachmark notification\"}\n                  >\n                    Welcome to the land of Coachmarks!\n                  </Coachmark>\n                </div>\n              </div>\n\n              {/* {siteUrl && (\n                 \n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n              {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n              {showTable && (\n                <>\n                  <div style={{ textAlign: \"right\" }}>\n                    <i\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                      onClick={() => {\n                        window.open(tableUrl, \"_blank\");\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                  <iframe\n                    style={{\n                      border: \"0\",\n                      height: \"calc(100vh - 150px\",\n                      width: \"95vw\",\n                    }}\n                    src={tableUrl}\n                  ></iframe>\n                </>\n              )}\n              {/* {showCatalogue && showTabFeature && memberships.length > 0 && ( */}\n              <Modal\n                titleAriaId={1}\n                isOpen={isModalOpen}\n                onDismiss={() => setIsModalOpen(false)}\n                isBlocking={false}\n                containerClassName={contentStyles.container}\n                xdragOptions={dragOptions}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div style={{ flexGrow: 1 }}></div>\n                  <div>\n                    <IconButton\n                      styles={iconButtonStyles}\n                      iconProps={cancelIcon}\n                      ariaLabel=\"Close popup modal\"\n                      onClick={() => setIsModalOpen(false)}\n                    />\n                  </div>\n                </div>\n                <div className={contentStyles.body}>\n                  <TextField\n                    autoFocus={false}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                  <div style={{ display: \"flex\" }}>\n                    <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                      Show details\n                    </div>\n                    <div style={{ marginTop: \"16px\" }}>\n                      <Toggle\n                        checked={showDetails}\n                        onChange={(e, checked) => {\n                          setShowDetails(checked);\n                          setRefreshCounter(refreshCounter + 1);\n                        }}\n                      />\n                    </div>\n                    <div>\n                      {/* <ReactTags\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\n                    autofocus={false}\n                    tags={tags}\n                    suggestions={[\n                      {\n                        name: \"Teams\",\n                        id: \"teams\",\n                      },\n                      {\n                        name: \"SharePoint\",\n                        id: \"sharepoint\",\n                      },\n                      {\n                        name: \"Yammer\",\n                        id: \"yammer\",\n                      },\n                      {\n                        name: \"Private\",\n                        id: \"private\",\n                      },\n                      {\n                        name: \"Public\",\n                        id: \"public\",\n                      },\n                    ]}\n                    handleDelete={(i) => {\n                      const tgs = tags.slice(0);\n                      tgs.splice(i, 1);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                    handleAddition={(tag) => {\n                      var tgs = [].concat(tags, tag);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                  />  */}\n                    </div>\n                  </div>\n\n                  <ViewTeams\n                    onSaveTeam={addPin}\n                    onSaveChannel={addChannel}\n                    refreshCounter={refreshCounter}\n                    tiles={filteredTiles}\n                    details={showDetails}\n                    memberShips={filteredMemberShips}\n                    filter={filter}\n                    highlightStyle={{ backgroundColor: \"yellow\" }}\n                  />\n                </div>\n              </Modal>\n              {/* )} */}\n\n              {/* \n\n              */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\",\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {false && props && props.auth && props.auth.user && (\n        <div style={{ textAlign: \"center\" }}>\n          You are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\n          &nbsp;\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\n            https://portal.office.com/account/#apps\n          </a>\n        </div>\n      )}\n    </div>\n  );\n\n  function boardFileName() {\n    var name = props.board ? props.board : \"default\";\n    return `${name}.json`;\n  }\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\n\n\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\n\nimport config from \"./config\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\nimport { running } from \"animejs\";\n\nimport {verifyAccessForLanuchPad} from \"./helpers/LaunchPad\"\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nexport default function Onboard(props) {\n  const [checkMe, setCheckMe] = useState(\"pending\");\n  const [checkMemberships, setCheckMemberships] = useState(\"pending\");\n  const [checkTeam, setCheckTeam] = useState(\"pending\");\n  const [checkMyExtention, setCheckMyExtention] = useState(\"pending\");\n  const [checkOneDrive, setCheckOneDrive] = useState(\"pending\");\n  const [checkOneDriveFiles, setCheckOneDriveFiles] = useState(\"pending\");\n  \n\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  const inFrame = inIframe();\n\n  useEffect(() => {\n    async function run() {\n      await verifyAccessForLanuchPad(setCheckMe, setCheckMyExtention, setCheckOneDrive, setCheckOneDriveFiles, setCheckMemberships, setCheckTeam);\n    }\n    run();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"OnboardingContainer\" dir=\"ltr\">\n        {!inFrame && config.components.header}\n        \n        {/* <div className=\"ms-fontSize-32\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          Checking is everything have been setup for you\n        </div> */}\n       \n        {/* <div>\n          <div className=\"ms-fontSize-20\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          <p >jumpto365 are committed to leave your data within your own system, what is yours stay with you. \n          We do not copy any of your information what so ever, period!</p>\n\n           <p>But to make our app work for you, we need your organisation to trust us with the following areas</p>\n\n          \n          </div>\n          <p className=\"ms-fontSize-20\">Allow access to the following areas</p>\n          <ul>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read and write access to your profile and OneDrive (User.ReadWrite.All)</p>\n              <p>\n                We need this permission to be able to store your preferences as\n                well as your cached data on your profile, and access to store data into your OneDrive.\n              </p>\n              <p>\n                That in order to be able to give you the best performance and to\n                comply with good data pricavy.\n              </p>\n            </li>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read access to your Groups (Group.Read.All)</p>\n              <p>\n                We need this permission to be able to read details about your\n                group membership and the name, description and tab on your channels in Teams \n              </p>\n            </li>\n          </ul>\n        </div> */}\n        <div>\n          <p className=\"ms-fontSize-20\">Verifying access</p>\n          <ul>\n            <li>Checking access to your profile: ({checkMe})</li>\n            <li>Checking access to your extension: ({checkMyExtention})</li>\n            <li>Checking access to your memberships: ({checkMemberships})</li>\n            <li>Checking access to your teams: ({checkTeam})</li>\n\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}","/****\n *\n *\n *  version\n *  1.0\n *\n *\n *\n */\nimport Axios from \"axios\";\nimport moment from \"moment\";\nimport config from \"./config\";\nconst storageProvider = localStorage\nexport function setReturnPath(url){\n  storageProvider.setItem(\"returnto\", url);\n}\n\nexport function hasReturnPath(){\n  return storageProvider.getItem(\"returnto\");\n}\n\nexport function setSavedEmail(url){\n  storageProvider.setItem(\"email\", url);\n}\n\nexport function getSavedEmail(){\n  var email = storageProvider.getItem(\"email\") \n  \n  return email\n}\n\nexport function clearReturnPath(){\n  return storageProvider.removeItem(\"returnto\");\n  \n}\n\n\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nconst GETACCESSTOKEN = \"getAccessToken\";\nconst RESTOREURL = \"restoreUrl\";\nconst GETGRAPHUSER = \"getGraphUser\";\nconst LOGIN = \"login\";\nconst ACCESSTOKEN = \"access_token\";\nconst ACCESSEXPIRES = \"access_expires\";\n\nexport function isAccessTokenExpired() {\n  try {\n    var exp = storageProvider.getItem(ACCESSEXPIRES);\n    var expiresIn = moment(exp);\n    var now = moment();\n    var x = now.diff(expiresIn);\n    return x > 0 ? true : false;\n  } catch (error) {\n    return true;\n  }\n}\n\nfunction getReturnPath(subPath) {\n  return (\n    (window.location.hostname === \"localhost\"\n      ? window.location.protocol\n      : \"https:\") +\n    \"//\" +\n    window.location.hostname +\n    (window.location.port !== 80 &&\n    window.location.port !== 443 &&\n    window.location.port !== \"\"\n      ? \":\" + window.location.port\n      : \"\") +\n    \"/\" +\n    subPath\n  );\n}\n\n/**\n * http://localhost:3001/?admin_consent=True&tenant=df96b8c9-51a1-40cf-b8b1-4514be8e9668&state=12345&scope=User.ReadWrite+Files.ReadWrite.All\n */\nexport function getAdminConsent() {\n  var redirect_uri = getReturnPath(\"\");\n\n  var org = \"organizations\";\n\n  var host = `https://login.microsoftonline.com/${org}/v2.0/adminconsent?client_id=${config.clientId}&state=12345&redirect_uri=${redirect_uri}&scope=${config.scopes}`;\n\n  window.location.href = host;\n}\n\nexport function selectAccount() {\n  var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n  var client_id = config.clientId;\n  var response_type = \"id_token\";\n  var response_mode = \"fragment\";\n  var scope = config.scopes;\n\n  var redirect_uri = getReturnPath(\"\");\n\n  var url = `${host}?client_id=${client_id}&prompt=select_account&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n\n  window.location.href = url;\n}\n\nexport function signinWith(email) {\n  var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n  var client_id = config.clientId;\n  var response_type = \"id_token\";\n  var response_mode = \"fragment\";\n  var scope = config.scopes;\n\n  var redirect_uri = getReturnPath(\"\");\n\n  var url = `${host}?client_id=${client_id}&prompt=login&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1&login_hint=${email}`;\n\n  window.location.href = url;\n}\nexport function signOut() {\n  var redirect_uri = getReturnPath(\"signedout\");\n  var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/logout?post_logout_redirect_uri=${redirect_uri}`;\n\n  storageProvider.removeItem(ACCESSTOKEN);\n  storageProvider.removeItem(ACCESSEXPIRES);\n  window.location.href = host;\n\n  // https://login.microsoftonline.com/{tenant}/oauth2/v2.0/logout?post_logout_redirect_uri=https://localhost/myapp/\n}\n\n/**\n * Based on session storage - if no auth token is present, or if is to old, a auth sequence is initiated\n * @param {*} config\n * @param {*} callBackNotifyIfInteractionIsRequired\n */\nexport function authenticate(\n  config,\n  callBackNotifyIfInteractionIsRequired,\n  options\n) {\n  // https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow\n\n  return new Promise((resolve, reject) => {\n    var redirect_uri = getReturnPath(\"\");\n\n    // window.location.pathname;\n\n    var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n    var client_id = config.clientId;\n    var response_type = \"id_token\";\n    var response_mode = \"fragment\";\n    var scope = config.scopes;\n\n    var seq = \"\"; // storageProvider.getItem(\"authseq\");\n    var search = getSearchParametersFromHash(window.location.href);\n\n    var search2 = getSearchParametersFromHRef(window.location.href);\n\n    if (search.id_token) {\n      seq = GETACCESSTOKEN;\n    } else if (search.access_token) {\n      seq = RESTOREURL;\n    } else if (search.login) {\n      seq = LOGIN;\n    } else if (seq === \"\") {\n      if (storageProvider.getItem(ACCESSTOKEN)) {\n        seq = isAccessTokenExpired() ? GETACCESSTOKEN : GETGRAPHUSER;\n      } else {\n        seq = GETACCESSTOKEN;\n        if (callBackNotifyIfInteractionIsRequired) {\n          return callBackNotifyIfInteractionIsRequired(null, null, true);\n        }\n      }\n    }\n\n    if (search.error || search2.error) {\n      var e = search.error ? search.error : search2.error;\n\n      var handled = false;\n      switch (e) {\n        case \"interaction_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired(search, search2, true);\n            return;\n          }\n          storageProvider.removeItem(\"accesstoken\");\n          storageProvider.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"consent_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired(null, null, true);\n          }\n          //debugger;\n          storageProvider.removeItem(\"accesstoken\");\n          storageProvider.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&prompt=consent&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"invalid_request\":\n          break;\n        case \"unsupported_response_type\":\n          break;\n        case \"access_denied\":\n          break;\n        default:\n          if (storageProvider.setItem(\"returnto\", \"/\"))\n            window.location.href = \"#login\";\n          return;\n          handled = true;\n          break;\n      }\n      if (!handled) {\n        var errorMessage = search.error_description\n          ? search.error_description\n          : search2.error;\n        // alert(errorMessage\n\n        // );\n        //window.location.href = storageProvider.getItem(\"returnto\");\n        reject(errorMessage);\n        return;\n      }\n    }\n\n    switch (seq) {\n      case LOGIN:\n        storageProvider.setItem(\"returnto\", window.location.href);\n\n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n        window.location.href = url;\n        return;\n        break;\n      case GETACCESSTOKEN:\n        storageProvider.setItem(\"returnto\", window.location.href);\n\n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\n        window.location.href = url;\n        return;\n        break;\n      case GETGRAPHUSER:\n        storageProvider.removeItem(\"returnto\");\n\n        Axios.get(\"https://graph.microsoft.com/v1.0/me\", {\n          headers: {\n            \"content-type\": \"application/json\",\n            authorization: `Bearer ${storageProvider.getItem(ACCESSTOKEN)}`,\n          },\n        })\n          .then((result) => {\n            resolve({ user: result.data });\n          })\n          .catch((error) => {\n            //var txt = error.response.data.error.message;\n            if (\n              error &&\n              error.response &&\n              error.response.data &&\n              error.response.data.error\n            ) {\n              //alert(error.response.data.error.message)\n              resolve({ error: error.response.data.error.message });\n            } else {\n              resolve({ error });\n            }\n          });\n        break;\n\n      case RESTOREURL:\n        if (search.access_token) {\n          storageProvider.setItem(ACCESSTOKEN, search.access_token);\n\n          var expires = moment().add(search.expires_in, \"s\");\n\n          storageProvider.setItem(ACCESSEXPIRES, expires.toISOString());\n          if (storageProvider.getItem(\"returnto\"))\n            var newHref = storageProvider.getItem(\"returnto\")\n            storageProvider.removeItem(\"returnto\");\n            window.location.href = newHref;\n          return;\n        } else {\n          window.location.reload();\n        }\n        resolve();\n        break;\n\n      default:\n        resolve({\n          error:\n            \"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in\",\n        });\n        break;\n    }\n  });\n}\n","\n\nimport _ from \"lodash\";\nimport Axios from \"axios\";\n\n\n\nexport function getLicenseForUPN(upn) {\n  return new Promise((resolve, reject) => {\n    \n  if (!upn) return reject(\"Mssing upn\")\n  \n  \n  var s =  _.split(upn,\"@\")\n  if (s.length<2) return reject(\"Mssing domain part\")\n  var domain = _.toLower( s[1])\n\n\n  Axios\n  .get(`https://blob.jumpto365.com/licenses/${domain}.license.json`)\n  .then((response) => {\n    resolve(response.data);\n  })\n  .catch((e) => {\n    reject(e);\n  });\n})\n}\n","import React from \"react\";\nimport { Link } from \"office-ui-fabric-react/lib/Link\";\nimport {\n  DetailsList,\n  Selection,\n  IColumn,\n  buildColumns,\n  IColumnReorderOptions,\n  IDragDropEvents,\n  IDragDropContext,\n} from \"office-ui-fabric-react/lib/DetailsList\";\nimport { MarqueeSelection } from \"office-ui-fabric-react/lib/MarqueeSelection\";\nimport { getTheme, mergeStyles } from \"office-ui-fabric-react/lib/Styling\";\nimport _ from \"lodash\";\nimport {\n  CommandBar,\n  ICommandBarItemProps,\n} from \"office-ui-fabric-react/lib/CommandBar\";\nimport { IButtonProps } from \"office-ui-fabric-react/lib/Button\";\n\nconst overflowProps = { ariaLabel: \"More commands\" };\nconst theme = getTheme();\nconst margin = \"0 30px 20px 0\";\nconst dragEnterClass = mergeStyles({\n  backgroundColor: theme.palette.neutralLight,\n});\nconst controlWrapperClass = mergeStyles({\n  display: \"flex\",\n  flexWrap: \"wrap\",\n});\nconst textFieldStyles = {\n  root: { margin: margin },\n  fieldGroup: { maxWidth: \"100px\" },\n};\nconst togglesStyles = { root: { margin } };\n\nexport class DragableDetailsList extends React.Component {\n  _selection;\n\n  _dragDropEvents;\n  _draggedItem;\n  _draggedIndex;\n\n  componentDidUpdate(prevProps, prevState) {\n    if (!_.isEqual(prevProps.items, this.props.items)) {\n      this.setState({\n        items: this.props.items,\n        columns: buildColumns(this.props.items, true),\n      });\n    }\n  }\n  cmdItems = () => {\n    var items = [];\n\n    switch (this._selection.getSelectedCount()) {\n      case 0:\n        items = [\n          {\n            key: \"newItem\",\n            text: \"New\",\n            cacheKey: \"myCacheKey\", // changing this key will invalidate this item's cache\n            iconProps: { iconName: \"Add\" },\n            //   subMenuProps: {\n            //     items: [\n            //       {\n            //         key: 'emailMessage',\n            //         text: 'Email message',\n            //         iconProps: { iconName: 'Mail' },\n            //         ['data-automation-id']: 'newEmailButton', // optional\n            //       },\n            //       {\n            //         key: 'calendarEvent',\n            //         text: 'Calendar event',\n            //         iconProps: { iconName: 'Calendar' },\n            //       },\n            //     ],\n            //   },\n          },\n          {\n            key: \"upload\",\n            text: \"Upload\",\n            iconProps: { iconName: \"Upload\" },\n            href: \"https://developer.microsoft.com/en-us/fluentui\",\n          }\n          \n        ];\n        break;\n      case 1:\n        items = [\n          {\n            key: \"share\",\n            text: \"Share\",\n\n            iconProps: { iconName: \"Share\" },\n            onClick: () => console.log(\"Share\"),\n          },\n          {\n            key: \"download\",\n            text: \"Download\",\n   \n            iconProps: { iconName: \"Download\" },\n            onClick: () => console.log(\"Download\"),\n          },\n         \n          {\n            key: \"delete\",\n            text: \"Delete\",\n \n            iconProps: { iconName: \"Delete\" },\n            onClick: () => console.log(\"Delete\"),\n          },\n        ];\n        break;\n      default:\n        items = [\n          {\n            key: \"share\",\n            text: \"Share\",\n\n            iconProps: { iconName: \"Share\" },\n            onClick: () => console.log(\"Share\"),\n          },\n          \n          {\n            key: \"download\",\n            text: \"Download\",\n\n            iconProps: { iconName: \"Download\" },\n            onClick: () => console.log(\"Download\"),\n          },\n          {\n            key: \"delete\",\n            text: \"Delete\",\n \n            iconProps: { iconName: \"Delete\" },\n            onClick: () => console.log(\"Delete\"),\n          },\n        ];\n        break;\n    }\n\n    return items;\n  };\n  constructor(props) {\n    super(props);\n    var that = this;\n    this._selection = new Selection({\n      selectionMode: 2,\n      onSelectionChanged: (x, y) => {\n        console.log(this._draggedIndex);\n        this.setState({ _items: this.cmdItems() });\n      },\n    });\n\n    this._dragDropEvents = this._getDragDropEvents();\n    this._draggedIndex = -1;\n    //const items = [] // createListItems(10, 0);\n\n    this.state = {\n      items: props.items,\n      columns: buildColumns(props.items, true),\n      isColumnReorderEnabled: false,\n      frozenColumnCountFromStart: \"0\",\n      frozenColumnCountFromEnd: \"0\",\n      _items: this.cmdItems(),\n\n      _overflowItems: [\n        {\n          key: \"move\",\n          text: \"Move to...\",\n          onClick: () => console.log(\"Move to\"),\n          iconProps: { iconName: \"MoveToFolder\" },\n        },\n        {\n          key: \"copy\",\n          text: \"Copy to...\",\n          onClick: () => console.log(\"Copy to\"),\n          iconProps: { iconName: \"Copy\" },\n        },\n        {\n          key: \"rename\",\n          text: \"Rename...\",\n          onClick: () => console.log(\"Rename\"),\n          iconProps: { iconName: \"Edit\" },\n        },\n      ],\n\n      _farItems: [\n        // {\n        //   key: \"tile\",\n        //   text: \"Grid view\",\n        //   // This needs an ariaLabel since it's icon-only\n        //   ariaLabel: \"Grid view\",\n        //   iconOnly: true,\n        //   iconProps: { iconName: \"Tiles\" },\n        //   onClick: () => console.log(\"Tiles\"),\n        // },\n        {\n          key: \"info\",\n          text: \"Info\",\n          // This needs an ariaLabel since it's icon-only\n          ariaLabel: \"Info\",\n          iconOnly: true,\n          iconProps: { iconName: \"Info\" },\n          onClick: () => console.log(\"Info\"),\n        },\n      ],\n    };\n  }\n\n  render() {\n    const {\n      items,\n      columns,\n      isColumnReorderEnabled,\n      frozenColumnCountFromStart,\n      frozenColumnCountFromEnd,\n      _items,\n      _overflowItems,\n      _farItems,\n    } = this.state;\n\n    return (\n      <div>\n        <CommandBar\n          items={_items}\n          overflowItems={_overflowItems}\n          overflowButtonProps={overflowProps}\n          farItems={_farItems}\n          ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n        />\n        <MarqueeSelection selection={this._selection}>\n          <DetailsList\n            setKey=\"items\"\n            items={items}\n            columns={columns}\n            selection={this._selection}\n            selectionPreservedOnEmptyClick={true}\n            onItemInvoked={this._onItemInvoked}\n            onRenderItemColumn={this._onRenderItemColumn}\n            dragDropEvents={this._dragDropEvents}\n            columnReorderOptions={\n              this.state.isColumnReorderEnabled\n                ? this._getColumnReorderOptions()\n                : undefined\n            }\n            ariaLabelForSelectionColumn=\"Toggle selection\"\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n            checkButtonAriaLabel=\"Row checkbox\"\n          />\n        </MarqueeSelection>\n      </div>\n    );\n  }\n\n  _handleColumnReorder = (draggedIndex, targetIndex) => {\n    const draggedItems = this.state.columns[draggedIndex];\n    const newColumns = [...this.state.columns];\n\n    // insert before the dropped item\n    newColumns.splice(draggedIndex, 1);\n    newColumns.splice(targetIndex, 0, draggedItems);\n    this.setState({ columns: newColumns });\n  };\n\n  _getColumnReorderOptions() {\n    return {\n      frozenColumnCountFromStart: parseInt(\n        this.state.frozenColumnCountFromStart,\n        10\n      ),\n      frozenColumnCountFromEnd: parseInt(\n        this.state.frozenColumnCountFromEnd,\n        10\n      ),\n      handleColumnReorder: this._handleColumnReorder,\n    };\n  }\n\n  _validateNumber(value) {\n    return isNaN(Number(value))\n      ? `The value should be a number, actual is ${value}.`\n      : \"\";\n  }\n\n  _onChangeStartCountText = (event, text) => {\n    this.setState({ frozenColumnCountFromStart: text });\n  };\n\n  _onChangeEndCountText = (event, text) => {\n    this.setState({ frozenColumnCountFromEnd: text });\n  };\n\n  _onChangeColumnReorderEnabled = (ev, checked) => {\n    this.setState({ isColumnReorderEnabled: checked });\n  };\n\n  _getDragDropEvents() {\n    return {\n      canDrop: (dropContext, dragContext) => {\n        return true;\n      },\n      canDrag: (item) => {\n        return true;\n      },\n      onDragEnter: (item, event) => {\n        // return string is the css classes that will be added to the entering element.\n        return dragEnterClass;\n      },\n      onDragLeave: (item, event) => {\n        return;\n      },\n      onDrop: (item, event) => {\n        if (this._draggedItem) {\n          this._insertBeforeItem(item);\n        }\n      },\n      onDragStart: (item, itemIndex, selectedItems, event) => {\n        this._draggedItem = item;\n        this._draggedIndex = itemIndex;\n      },\n      onDragEnd: (item, event) => {\n        this._draggedItem = undefined;\n        this._draggedIndex = -1;\n      },\n    };\n  }\n\n  _onItemInvoked = (item) => {\n    alert(`Item invoked: ${item.name}`);\n  };\n\n  _onRenderItemColumn = (item, index, column) => {\n    const key = column.key;\n    if (key === \"name\") {\n      return <Link data-selection-invoke={true}>{item[key]}</Link>;\n    }\n\n    return String(item[key]);\n  };\n\n  _insertBeforeItem(item) {\n    const draggedItems = this._selection.isIndexSelected(this._draggedIndex)\n      ? this._selection.getSelection()\n      : [this._draggedItem];\n\n    const insertIndex = this.state.items.indexOf(item);\n    const items = this.state.items.filter(\n      (itm) => draggedItems.indexOf(itm) === -1\n    );\n\n    items.splice(insertIndex, 0, ...draggedItems);\n\n    this.setState({ items });\n  }\n}\n","import * as React from \"react\";\n\nlet UserContext = React.createContext();\n\nlet initialState = {\n  user: {},\n  license:{}\n};\n\nlet reducer = (state, action) => {\n  switch (action.type) {\n    case \"reset\":\n      return initialState;\n    case \"increment\":\n      return { ...state, count: state.count + 1 };\n    case \"decrement\":\n      return { ...state, count: state.count - 1 };\n    case \"set-color\":\n      return { ...state, currentColor: action.payload };\n  }\n};\n\nfunction UserContextProvider(props) {\n  // [A]\n  let [state, dispatch] = React.useReducer(reducer, initialState);\n  let value = { state, dispatch };\n\n\n  // [B]\n  return (\n    <UserContext.Provider value={value}>{props.children}</UserContext.Provider>\n  );\n}\n\nlet UserContextConsumer = UserContext.Consumer;\n\n// [C]\nexport { UserContext , UserContextProvider , UserContextConsumer  };","import React, { useEffect, useState, useRef } from \"react\";\nimport \"./style.css\";\nimport config from \"../../config\";\nimport { inIframe } from \"../../helpers\";\nexport default function Wrapper(props) {\n  \n\n  return (\n    <div className=\"homePage section\">\n      {!inIframe() && config.components.header}\n      <div className=\"container\">\n        {props.children}\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState, useRef } from \"react\";\nimport { DefaultButton, PrimaryButton, TextField } from \"office-ui-fabric-react/lib/index\";\nimport \"./style.css\";\nimport { Link, navigate } from \"@reach/router\";\nimport axios from \"axios\";\nimport config from \"../../config\";\nimport { inIframe } from \"../../helpers\";\nimport {\n  signinWith,setReturnPath,setSavedEmail,getSavedEmail\n} from \"../../authenticate\";\nimport Wrapper from \"../Wrapper\";\nexport default function HomePage() {\n  const [user, setUser] = useState(null);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [email, setEmail] = useState(\"\");\n  const [isProcessing,setIsProcessing] = useState(false);\n  \n  const mailInput = useRef(null);\n\n  useEffect(()=>{\n     // current property is refered to input element\n     debugger\n     setEmail(getSavedEmail())\n     if (mailInput.current) {mailInput.current.focus();}\n  },[])\n\n  const validateEmail = (email) => {\n\n\n      // don't remember from where i copied this code, but this works.\n      let re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n      if ( re.test(email) ) {\n        setErrorMessage(null)\n          // this is a valid email address\n          // call setState({email: email}) to update the email\n          // or update the data in redux store.\n      }\n      else {\n        setErrorMessage(\"Enter a valid email address\")\n          // invalid email, maybe show an error to the user.\n      }\n  }\n  const processEmail = () => {\n    setErrorMessage(null);\n    setIsProcessing(true)\n\n    var data = JSON.stringify({ email });\n\n    var config = {\n      method: \"post\",\n      url:\n        \"https://prod-44.northeurope.logic.azure.com:443/workflows/7de38d3eaea84179800d7ec6da48cef8/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=mcDwAJFptdj3ZVSdDWVpGtch-sVvMZpOlB5Dv8QMXxI\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      data: data,\n    };\n    axios(config)\n      .then(function (response) {\n      if (response.data.affiliated){\n        setSavedEmail(email)\n        setReturnPath(response.data.url)\n        signinWith(email)\n      }\n      else{\n        setIsProcessing(false)\n        setErrorMessage(\"You cannot use that email address to get access\")\n\n      }\n                \n      })\n      .catch(function (error) {\n        setIsProcessing(false)\n        setErrorMessage(\"You cannot use that email address to get access\")\n        //setErrorMessage(error.message);\n        \n      });\n  };\n  return (\n  <Wrapper>\n \n        <div className=\"speedDateActions\">\n          \n          <TextField\n          className=\"email\"\n          \n          componentRef={mailInput}\n           type=\"email\"\n           placeholder={\"Enter your login email addresss \" }\n            required\n            \n            defaultValue={email}\n            errorMessage={errorMessage}\n            onChange={(a, b) => {\n              setEmail(b);\n              validateEmail(b)\n            }}\n          />\n          <div style={{ padding: \"10px\"}}>\n          \n          <PrimaryButton className=\"signin\"\n            disabled={isProcessing || errorMessage || email.length === 0}\n              onClick={() => {\n                processEmail();\n              }}\n            >\n              Continue\n            </PrimaryButton>\n          </div>\n          <div className=\"helplink\">\n          <a  href=\"https://www.nets-intranets.com/help/guest-account\">Looking for help?</a>\n          </div>\n            \n        </div>\n      </Wrapper>\n  );\n}\n","import React, { useEffect, useState, useRef } from \"react\";\nimport {\n  ChoiceGroup,\n  DefaultButton,\n  PrimaryButton,\n} from \"office-ui-fabric-react/lib/index\";\nimport { MyTeams } from \"../../helpers/OfficeGraph\";\nimport \"./style.css\";\nimport { navigate } from \"@reach/router\";\nimport Wrapper from \"../Wrapper\";\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport {\n  getSearchParametersFromHRef,\n  inIframe,\n  teamsMeetingUrlFromBody,\n} from \"../../helpers\";\n\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport {\n  MessageBarButton,\n  Link,\n  Stack,\n  StackItem,\n  MessageBar,\n  MessageBarType,\n  IStackProps,\n} from \"office-ui-fabric-react\";\nexport default function StartDatePage(props) {\n  const [joinedTeams, setJoinedTeams] = useState([]);\n  const [selectedTeam, setSelectedTeam] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [meetingUrl, setMeetingUrl] = useState(null);\n\n  const [speedDate, setSpeedDate] = useState(null);\n  const [errors, setErrors] = useState([]);\n  const [progress, setProgress] = useState(\"\");\n  const [progressPercent, setProgressPercent] = useState(null);\n\n  const meetNow = (team) => {\n    setProcessing(true);\n    var sponsor = props.auth && props.auth.user ? props.auth.user.mail : \"\";\n    var from = moment().add(5, \"minutes\").format(\"YYYY-MM-DDTHH:mm:00\");\n    var to = moment().add(10, \"minutes\").format(\"YYYY-MM-DDTHH:mm:00\");\n    var data = JSON.stringify({\n      url: \"https://itpro.jumpto365.com\",\n      linkText: \"Get started\",\n      subject: \"Welcome to jumpto365 for IT Professionals\",\n      from,\n      to,\n      teamName: team.displayName,\n      teamId: team.id,\n      sponsor,\n      facilitator1: \"niels@jumpto365.com\",\n      facilitator2: \"niels@jumpto365.com\",\n      // optionalAttendeesEmails: [\"dsf\", \"asf\"],\n      // attendeesEmails: [\"dsf\", \"asf\"],\n    });\n\n    var config = {\n      method: \"post\",\n      url:\n        \"https://prod-26.northeurope.logic.azure.com:443/workflows/cf350587a4ba4621b3d63e8538076a5c/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=66v57Zr6-OZt6n24i0AabA3hrWD0k-kM_Qqle7C4_Ro\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        setSpeedDate(response.data);\n        debugger\n        var _meetingUrl = teamsMeetingUrlFromBody(response.data.event.body.content)\n        setMeetingUrl(\n          _meetingUrl\n        );\n\n        setProcessing(false);\n        console.log(JSON.stringify());\n      })\n      .catch(function (error) {\n        errors.push({ context: \"meetNow\", error });\n        setProcessing(false);\n        setErrors(errors);\n        console.log(error);\n      });\n  };\n \nvar _meetingUrl = meetingUrl\n\n  return (\n    <div>\n     <Wrapper meetingUrl={meetingUrl} processing={processing}> \n      {processing && (\n        <ProgressIndicator label=\"Preparing a speed date for you\" />\n      )}\n      <h1>Welcome</h1>\n      <div>\n        <h3>\n          Hope you can set a side 5 minutes to let us know your areas of\n          interest and competances. We will use the session to make you member\n          of relevant teams\n        </h3>\n        <div xclassName=\"speedDateActions\">\n          {!meetingUrl && (\n            <PrimaryButton\n              disabled={processing===true}\n              onClick={() => {\n                meetNow({\nid:\"ff37e5be-d5d3-40e3-ab6b-3a8490d1dc83\",\ndisplayName:\"IT Pros\"\n                });\n              }}\n              className=\"speedDateActions\"\n            >\n              Yes, connect me {processing===true}\n            </PrimaryButton>\n          )}\n          {meetingUrl && (\n          \n            <PrimaryButton className=\"speedDateActions\" href={ _meetingUrl }>\n              Join meeting now \n            </PrimaryButton>\n          )}\n        </div>\n      </div>\n      {/* <div style={{ minHeight: \"50vh\" }}>\n        <ChoiceGroup\n          options={joinedTeams}\n          onChange={(e, selected) => {\n            setSelectedTeam(selected);\n          }}\n          label=\"Select Team\"\n          required={true}\n        />\n      </div>\n      <div className=\"speedDateActions\">\n        <DefaultButton\n          onClick={() => {\n            navigate(`/test`);\n          }}\n        >\n          Previous\n        </DefaultButton>\n        <PrimaryButton\n          disabled={selectedTeam === null}\n          onClick={() => {\n            navigate(`/start/${selectedTeam.key}`);\n          }}\n        >\n          Next\n        </PrimaryButton>\n      </div> */}\n   </Wrapper>\n    </div>\n  );\n}\n","import React, { useEffect, useState, useRef } from \"react\";\nimport {\n  ChoiceGroup,\n  DefaultButton,\n  PrimaryButton,\n} from \"office-ui-fabric-react/lib/index\";\nimport { MyTeam, readTeamInfoAsGuest } from \"../../helpers/OfficeGraph\";\nimport \"./style.css\";\nimport { navigate } from \"@reach/router\";\nexport default function StartDateTeamSelectedPage(props) {\n  const [team, setTeam] = useState(null);\n  const [channels, setChannels] = useState([]);\n  useEffect(() => {\n    async function load() {\n      {\n        MyTeam(props.teamid).then(async (_team) => {\n          setTeam(_team);\n          var info = await readTeamInfoAsGuest(_team);\n          if (info && info.data && info.data.channels) {\n            setChannels(info.data.channels);\n          }\n        });\n      }\n    }\n\n    load();\n  }, []);\n\n  return (\n    <div className=\"homePage\">\n      <div>\n        <div style={{ minHeight: \"50vh\" }}>\n          {team && (\n            <div>\n              <h1>{team.displayName}</h1>\n            </div>\n          )}\n          {channels && (\n            <div>\n              {channels.map((channel) => {\n                return (\n                  <div>\n                    <h3>{channel.displayName}</h3>\n                    {channel.description &&\n                      channel.description !== channel.displayName && (\n                        <div>{channel.description}</div>\n                      )}\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </div>\n        <div className=\"speedDateActions\">\n          <DefaultButton\n            onClick={() => {\n              navigate(`/start`);\n            }}\n          >\n            Previous\n          </DefaultButton>\n          <PrimaryButton\n            disabled={team === null}\n            onClick={() => {\n              navigate(`/start/${team.id}/`);\n            }}\n          >\n            Next\n          </PrimaryButton>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState, useRef } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport Home from \"./Home\";\nimport Onboard from \"./Onboard\";\nimport config from \"./config\";\nimport {\n  authenticate,\n  hasReturnPath,clearReturnPath,\n  isAccessTokenExpired,\n  signOut,\n  getAdminConsent,\n  selectAccount,\n} from \"./authenticate\";\nimport { getLicenseForUPN } from \"./helpers/License\";\nimport { FluentCustomizations } from \"@uifabric/fluent-theme\";\nimport {\n  Customizer,\n  mergeStyles,\n  Fabric,\n  classNamesFunction,\n} from \"office-ui-fabric-react\";\nimport { loadTheme } from \"@fluentui/react\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\n\nimport { Router, Link, navigate } from \"@reach/router\";\nimport {\n  MessageBarButton,\n  DefaultButton,\n} from \"office-ui-fabric-react/lib/Button\";\nimport Boards from \"./containers/Boards\";\nimport { indexLaunzhBoards } from \"./helpers/LaunchPad\";\nimport { UserContext } from \"./helpers/UserContext\";\nimport { inIframe } from \"./helpers\";\nimport {\n  MessageBar,\n  MessageBarType,\n  ChoiceGroup,\n  IStackProps,\n} from \"office-ui-fabric-react\";\nimport pack from \"../package.json\";\nimport HomePage from \"./containers/HomePage\";\nimport StartDatePage from \"./containers/StartDatePage\";\nimport StartDateTeamSelectedPage from \"./containers/StartDateTeamSelectedPage\";\nimport _ from \"lodash\"\nconst storageProvider = localStorage;\nexport default class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, info) {\n    // You can also log the error to an error reporting service\n    this.setState({ error, info });\n    console.log(\"componentDidCatch\", error, info);\n    //logErrorToMyService(error, info);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return (\n        <div className=\"pageBody\">\n          <h1 className=\"errorCenterHeader\">\n            Sorry! Something not working as expected\n          </h1>\n          {this.state.error && this.state.error.message && (\n            <h2>{this.state.error.message}</h2>\n          )}\n          <div className=\"errorCenterHeader\">\n     \n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"View error details\"\n                onClick={() => {\n                  this.setState({ viewDetails: true });\n                }}\n              />\n            </div>\n          </div>\n          {this.state.info &&\n          this.state.info.componentStack &&\n          this.state.viewDetails ? (\n            <div>\n              <textarea\n                style={{ width: \"100%\" }}\n                readOnly\n                rows=\"30\"\n                cols=\"80\"\n                value={this.state.info.componentStack}\n              />{\" \"}\n            </div>\n          ) : null}\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nvar x = loadTheme({\n  defaultFontStyle: {\n    fontFamily: \"Monaco, Menlo, Consolas\",\n    fontWeight: \"regular\",\n  },\n  fonts: {\n    small: {\n      fontSize: \"11px\",\n    },\n    medium: {\n      fontSize: \"13px\",\n    },\n    large: {\n      fontSize: \"20px\",\n      fontWeight: \"semibold\",\n    },\n    xLarge: {\n      fontSize: \"22px\",\n      fontWeight: \"semibold\",\n    },\n  },\n});\n\n// // Inject some global styles\n// mergeStyles({\n//   selectors: {\n//     ':global(body), :global(html), :global(#root)': {\n//       margin: 0,\n//       padding: 0,\n//       height: '100vh'\n//     }\n//   }\n// });\n\nfunction showException(props) {\n  ReactDOM.render(\n    <Customizer {...FluentCustomizations}>\n      <Fabric theme={x}>\n        <ErrorBoundary>\n          <div\n            style={{\n              marginTop: \"100px\",\n              maxWidth: \"1024px\",\n              marginLeft: \"auto\",\n              marginRight: \"auto\",\n            }}\n          >\n            <h1> Sorry, can't get you in</h1>\n            <h3>{props && props.errorMessage}</h3>\n            <p>\n              The following checks might give you and indication of what is\n              wrong\n            </p>\n            <Onboard />\n            <p>Suggested actions</p>\n            <DefaultButton\n              onClick={() => {\n                localStorage.clear();\n                sessionStorage.clear();\n                window.location.href = \"/\";\n              }}\n            >\n              Clear cache and login\n            </DefaultButton>\n          </div>\n        </ErrorBoundary>\n      </Fabric>\n    </Customizer>,\n    document.getElementById(\"root\")\n  );\n}\n\nfunction Container(props) {\n  return (\n    <div style={{ minHeight: \"100vh\", minWidth: \"100vw\" }}>\n      <div\n        style={{ maxWidth: \"1200px\", marginLeft: \"auto\", marginRight: \"auto\" }}\n      >\n        {props.children}\n      </div>\n    </div>\n  );\n}\nfunction GotoDefault() {\n  window.location.href = \"/home\";\n  return null;\n}\n\nfunction GetAdminConsented() {\n  getAdminConsent();\n  return null;\n}\nfunction AdminConsented() {\n  return <Container>Thank you for the consent\"</Container>;\n}\nfunction SignedOut() {\n  return <Container>You have been signed out</Container>;\n}\nfunction SignOut() {\n  signOut();\n  return null;\n}\nfunction SelectAccount() {\n  selectAccount();\n  return null;\n}\nfunction NoPage() {\n  return <Container>Page not found</Container>;\n}\n\nfunction Autorized(props) {\n  if (!props && !props.auth) {\n    window.location.href = \"/signin?returnto=\" + window.location.href;\n    return null;\n  }\n  return props.children;\n}\n\nfunction Debug() {\n  return (\n    <Container>\n      <div>\n        <div>\n          <a href=\"/getadminconsent\">Get Admin Consent</a>{\" \"}\n        </div>\n        <div>\n          <a href=\"/signout\">Sign Out</a>{\" \"}\n        </div>\n        <div>\n          <a href=\"/selectaccount\">Select Account</a>{\" \"}\n        </div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n      </div>\n    </Container>\n  );\n}\nfunction InteractionRequired(props) {\n  const [showWarning, setShowWarning] = useState(true);\nif (props && props.noauthPaths){\n  var skipAuth = false\n  var currentPath = window.location.pathname\n  props.noauthPaths.forEach(noauthPath => {\n    \n    if (_.isEqual(currentPath,noauthPath)){\n      skipAuth = true\n    }\n  });\n  if (skipAuth) return null\n}\n  if (!props.interactionRequired) return null;\n\n  function backgroundCheck() {\n    if (!isAccessTokenExpired) {\n      window.location.reload();\n      return;\n    }\n    //if (storageProvider.getItem(\"\"))\n    setTimeout(backgroundCheck, 1000);\n  }\n\n  //backgroundCheck()\n  return (\n    <div style={{ position: \"fixed\", width: \"100vw\", zIndex: 10 }}>\n      <MessageBar\n        messageBarType={MessageBarType.error}\n        isMultiline={false}\n        onDismiss={() => {\n          setShowWarning(false);\n        }}\n        dismissButtonAriaLabel=\"Close\"\n        actions={\n          <div>\n            {!inIframe() && (\n              <MessageBarButton\n                onClick={() => {\n                  selectAccount();\n                }}\n              >\n                {\" \"}\n                Sign in\n              </MessageBarButton>\n            )}\n\n            {inIframe() && (\n              <>\n                <a href=\"#\" target=\"_blank\">\n                  Click here to open in new tab and sign in\n                </a>\n                {false && (\n                  <MessageBarButton\n                    onClick={() => {\n                      window.Office.context.ui.displayDialogAsync(\n                        \"https://localhost:3002\"\n                      );\n                      //window.location.reload();\n                    }}\n                  >\n                    {\" \"}\n                    Reload\n                  </MessageBarButton>\n                )}\n              </>\n            )}\n          </div>\n        }\n      >\n        We need to sign you in\n      </MessageBar>\n    </div>\n  );\n}\nfunction getUserAndLicense() {\n  return new Promise(async (resolve, reject) => {\n    var auth = await authenticate(\n      config,\n      (search, search2, interactionRequired) => {\n        return resolve({ interactionRequired });\n        var errorMessage =\n          search && search.error_description\n            ? search.error_description\n            : search2 && search2.error_description\n            ? search2 && search2.error_description\n            : \"Unknown error\";\n        showException({ errorMessage });\n        // this is where you can send a signal to a host that intercati ons is required\n      }\n    ).catch((error) => {\n      reject(error);\n    });\n    if (!auth) return;\n\n    var license = await getLicenseForUPN(\n      auth && auth.user ? auth.user.userPrincipalName : null\n    ).catch((e) => {\n      console.log(\"getLicenseForUPN\", e);\n    });\n\n    who(auth.user.userPrincipalName);\n    const key = \"HASLANDED\";\n\n    var landed = storageProvider.getItem(key);\n    if (!landed) {\n      trace(EVENT.LANDING);\n      storageProvider.setItem(key, \"1\");\n    }\n    resolve({ auth, license });\n  });\n}\n\nfunction SpeedDateApp() {\n  const [auth, setAuth] = useState(null);\n\n  const [license, setLicense] = useState(null);\n  const [interactionRequired, setInteractionRequired] = useState(false);\n  // let { userContext, dispatch } = React.useContext(UserContext);\n  useEffect(() => {\n    getUserAndLicense()\n      .then((result) => {\n        if (result.interactionRequired) {\n          setInteractionRequired(true);\n        } else {\n          setAuth(result.auth);\n          setLicense(result.license);\n        }\n      })\n      .catch((error) => {\n        console.log(\"getUserAndLicense\", error);\n      });\n  }, []);\n  return (\n    <div>\n      <Customizer {...FluentCustomizations}>\n        <Fabric theme={x}>\n          <ErrorBoundary>\n            <InteractionRequired interactionRequired={interactionRequired} noauthPaths={[\"/\"]} />\n            <Router>\n              <Onboard path=\"/check\" />\n              <GotoDefault auth={auth} path=\"/default\" />\n              <HomePage path=\"/\" />\n\n              <StartDatePage auth={auth} path=\"/start\" />\n              \n              \n              <StartDateTeamSelectedPage path=\"/start/:teamid\"/>\n              <Home auth={auth} path=\"/home\" />\n              <App auth={auth} path=\"/board/:board\" signOut={signOut} />\n              <GetAdminConsented path=\"/getadminconsent\" />\n              <AdminConsented path=\"/adminconsented\" />\n              <SignedOut path=\"/signedout\" />\n              <SignOut path=\"/signout\" />\n              <Debug path=\"/debug\" />\n              <NoPage default />\n            </Router>\n          </ErrorBoundary>\n        </Fabric>\n      </Customizer>\n      <div style={{position:\"fixed\",bottom:\"0\"}}>\n      {pack.version}\n      </div>\n    </div>\n  );\n  \n}\n\nasync function start() {\n  if (window.location.hash.indexOf(\"error=\") > -1) {\n    authenticate(config);\n  } else {\n    ReactDOM.render(<SpeedDateApp />, document.getElementById(\"root\"));\n  }\n}\nif (window.Office)\n  window.Office.initialize = () => {\n    console.log(\"Office running\");\n  };\n\n\n  if(hasReturnPath())  {\n    \n    window.location.href =hasReturnPath()\n    clearReturnPath() \n\n  }else{\n\nstart();\n}\n","import React from \"react\";\nimport _ from \"lodash\";\nimport ReactGridLayout, { Responsive } from \"react-grid-layout\";\nimport \"./Toolbox.css\";\nimport WidthProvider from \"./WidthProvider\"\n\n\nexport const breakpoints = {lg: 1200, md: 996, sm: 768, xs: 480, xxs: 240}\nvar ResponsiveReactGridLayout\nexport default class ToolboxLayout extends React.Component {\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function () {},\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n    initialLayout: generateLayout(),\n  };\n\n  constructor(props) {\n    super(props);\n    ResponsiveReactGridLayout = WidthProvider(Responsive,props.fixedWidth);\n    this.state = {\n      currentBreakpoint: \"lg\",\n      compactType: \"vertical\",\n      mounted: false,\n      // layouts: props.layouts\n      //   ? props.layouts\n      //   : {\n      //       lg: props.tools\n      //         ? props.tools.map((tool, ix) => {\n      //             return {\n      //               x: 0,\n      //               y: ix,\n      //               w: 3,\n      //               h: 3,\n\n      //               i: ix.toString(),\n\n      //               static: 0, //Math.random() < 0.05,\n      //             };\n      //           })\n      //         : props.initialLayout,\n      //     },\n      toolbox: { lg: [] },\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n  }\n\n  generateDOM(x,y) {\n    var that = this;\n    \n    return _.map(this.props.layouts[this.state.currentBreakpoint], (l) => {\n      \n      var tile =\n        that.props.tools && that.props.tools[l.i] && that.props.tools[l.i].tile\n          ? that.props.tools[l.i].tile\n          : { title: l.i };\n          {var refresh = Date.now()}\n      return (\n        <div\n          style={{\n            backgroundColor: tile.color,\n            color: tile.textcolor,\n            cursor: !this.props.editingLayout ? \"pointer\" : \"default\",\n            overflow:\"hidden\"\n          }}\n          // onClick={() => {\n          //   if (this.props.onTileClick && !this.props.editingLayout) {\n          //     this.props.onTileClick(tile);\n          //   }\n          // }}\n          key={l.i}\n\n          data-grid={{w:l.w,h:l.h,x:l.x,y:l.y}}\n          className={l.static ? \"static\" : \"\"}\n        >\n       \n          <span >\n          \n        {/* {refresh} {l.w}x{l.h} */}\n            {that.props.getPin(l.i,l.w,l.h,refresh)} \n            </span>\n        </div>\n      );\n    });\n  }\n\n  onBreakpointChange = (breakpoint) => {\n    this.setState((prevState) => ({\n      currentBreakpoint: breakpoint,\n      toolbox: {\n        ...prevState.toolbox,\n        [breakpoint]:\n          prevState.toolbox[breakpoint] ||\n          prevState.toolbox[prevState.currentBreakpoint] ||\n          [],\n      },\n    }));\n  };\n\n  onCompactTypeChange = () => {\n    const { compactType: oldCompactType } = this.state;\n    const compactType =\n      oldCompactType === \"horizontal\"\n        ? \"vertical\"\n        : oldCompactType === \"vertical\"\n        ? null\n        : \"horizontal\";\n    this.setState({ compactType });\n  };\n\n  onTakeItem = (item) => {\n    this.setState((prevState) => ({\n      toolbox: {\n        ...prevState.toolbox,\n        [prevState.currentBreakpoint]: prevState.toolbox[\n          prevState.currentBreakpoint\n        ].filter(({ i }) => i !== item.i),\n      },\n      layouts: {\n        ...prevState.layouts,\n        [prevState.currentBreakpoint]: [\n          ...prevState.layouts[prevState.currentBreakpoint],\n          item,\n        ],\n      },\n    }));\n  };\n\n  onPutItem = (item) => {\n    this.setState((prevState) => {\n      return {\n        toolbox: {\n          ...prevState.toolbox,\n          [prevState.currentBreakpoint]: [\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\n            item,\n          ],\n        },\n        layouts: {\n          ...prevState.layouts,\n          [prevState.currentBreakpoint]: prevState.layouts[\n            prevState.currentBreakpoint\n          ].filter(({ i }) => i !== item.i),\n        },\n      };\n    });\n  };\n\n  onLayoutChange = (layout, layouts) => {\n    saveToLS(\"layouts\", layouts);\n\n    if (this.props.persist) {\n      this.props.persist(layouts);\n    }\n    this.setState({ layouts });\n  };\n\n  onNewLayout = () => {\n    this.setState({\n      layouts: { lg: generateLayout() },\n    });\n  };\n  onResize = () =>{\n    if (!this.props.tools) return\n    \n    this.props.tools.forEach(tool => {\n      if (tool.onResize) tool.onResize()\n    });\n\n  }\n  render() {\n    return (\n      <div>\n        {/* <div>\n          Current Breakpoint: {this.state.currentBreakpoint} (\n          {this.props.cols[this.state.currentBreakpoint]} columns)\n        </div>\n        <div>\n          Compaction type:{\" \"}\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\n        </div>\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\n        <button onClick={this.onCompactTypeChange}>\n          Change Compaction Type\n        </button> */}\n\n        {/* <ToolBox\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\n          onTakeItem={this.onTakeItem}\n        /> */}\n\n        <ResponsiveReactGridLayout\n       \n         breakpoints={breakpoints }\n         cols={{lg: 12, md: 10, sm: 6, xs: 4, xxs: 2}}\n          {...this.props}\n          margin={[0,0]}\n          containerPadding={[0,0]}\n\n          layouts={this.props.layouts}\n          onBreakpointChange={this.onBreakpointChange}\n          onLayoutChange={this.onLayoutChange}\n          // WidthProvider option\n          measureBeforeMount={false}\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n          // and set `measureBeforeMount={true}`.\n          useCSSTransforms={true}\n          compactType={this.state.compactType}\n          preventCollision={!this.state.compactType}\n          onResize={this.onResize}\n          isDraggable={this.props.editMode}\n          isResizable={this.props.editMode}\n        >\n          {this.generateDOM(this)}\n        </ResponsiveReactGridLayout>\n      </div>\n    );\n  }\n}\n\nfunction getFromLS(key) {\n  let ls = {};\n  if (global.localStorage) {\n    try {\n      ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\n    } catch (e) {\n      /*Ignore*/\n    }\n  }\n  return ls[key];\n}\n\nfunction saveToLS(key, value) {\n  if (global.localStorage) {\n    global.localStorage.setItem(\n      \"rgl-8\",\n      JSON.stringify({\n        [key]: value,\n      })\n    );\n  }\n}\nfunction generateLayout() {\n  return _.map(_.range(0, 25), function (item, i) {\n    var y = Math.ceil(Math.random() * 4) + 1;\n    return {\n      x: (_.random(0, 5) * 2) % 12,\n      y: Math.floor(i / 6) * y,\n      w: 2,\n      h: y,\n      i: i.toString(),\n      static: Math.random() < 0.05,\n    };\n  });\n}\n"],"sourceRoot":""}